<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Creating an Open Data Cube from STAC records – webtesting</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-3a86aad0115fdac71b8b5cec7ac8b57c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">webtesting</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">Details</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../test.qmd"> 
<span class="menu-text">Test2</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#stackstac-and-element-84-stac" id="toc-stackstac-and-element-84-stac" class="nav-link active" data-scroll-target="#stackstac-and-element-84-stac">STACKSTAC and Element-84 STAC</a></li>
  <li><a href="#stackstac-and-ceda-stac" id="toc-stackstac-and-ceda-stac" class="nav-link" data-scroll-target="#stackstac-and-ceda-stac">STACKSTAC and CEDA STAC</a></li>
  <li><a href="#workaround" id="toc-workaround" class="nav-link" data-scroll-target="#workaround">Workaround?</a></li>
  <li><a href="#odc-stac-and-element-84" id="toc-odc-stac-and-element-84" class="nav-link" data-scroll-target="#odc-stac-and-element-84">ODC-STAC and Element-84</a></li>
  <li><a href="#odc-stac-and-ceda-ard" id="toc-odc-stac-and-ceda-ard" class="nav-link" data-scroll-target="#odc-stac-and-ceda-ard">ODC-STAC and CEDA ARD</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Creating an Open Data Cube from STAC records</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>This notebook takes you through my thinking and testing so far in trying to generate an open data cube using the CEDA Sentinel 2 ARD STAC catalogue. The main sticking point is the fact that the band information is described under eo:bands.</p>
<p>I imagine that it must be possible to create an open data cube using, for example, all the red bands referenced under eo:bands, although many public datasets seem to have the individual spectral bands split out as individual assets.</p>
<p>Requirements (can be installed using <code>pip</code> on the EODh AppHub or through your environment manager):</p>
<ul>
<li>dask</li>
<li>folium</li>
<li>geopandas</li>
<li>shapely</li>
<li>pyproj</li>
<li>Ipython</li>
<li>pystac_client</li>
<li>stackstac</li>
<li>odc-stac</li>
<li>rioxarray</li>
</ul>
<div id="f98ab05f" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imports</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> dask.distributed</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> dask.diagnostics</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> folium</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shapely.geometry</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyproj</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pystac_client <span class="im">import</span> Client</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># the data cube bit</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> odc.stac <span class="im">import</span> configure_rio, stac_load </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> stackstac</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="279607d7" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#common variables</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>lon, lat <span class="op">=</span> <span class="op">-</span><span class="fl">1.3144</span>, <span class="fl">51.5755</span> <span class="co"># Atlas building at RAL</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>EURL <span class="op">=</span> <span class="st">"https://earth-search.aws.element84.com/v1"</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>CURL <span class="op">=</span> <span class="st">"https://api.stac.ceda.ac.uk/"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="stackstac-and-element-84-stac" class="level1">
<h1>STACKSTAC and Element-84 STAC</h1>
<p>The first thing I wanted to do was prove that it is possible to create an ODC from a STAC catalogue. To do this I followed the <code>stackstac</code> example using Element-84s STAC dataset:</p>
<p>See - https://stackstac.readthedocs.io/en/latest/basic.html</p>
<div id="e496530e" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Connect and search STAC catalogue</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>catalog <span class="op">=</span> Client.<span class="bu">open</span>(EURL)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>items <span class="op">=</span> catalog.search(</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    intersects<span class="op">=</span><span class="bu">dict</span>(<span class="bu">type</span><span class="op">=</span><span class="st">"Point"</span>, coordinates<span class="op">=</span>[lon, lat]),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    collections<span class="op">=</span>[<span class="st">"sentinel-2-l2a"</span>],</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    datetime<span class="op">=</span><span class="st">"2023-05-01/2023-11-30"</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>).item_collection()</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(items)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>76</code></pre>
</div>
</div>
<div id="89f0f3ff" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use stackstac to turn STAC items into a lazy xarray. </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Using all the defaults, our data will be in its native coordinate reference system, at the finest resolution of all the assets.</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>stack <span class="op">=</span> stackstac.stack(items)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/al/miniforge3/envs/eodh/lib/python3.12/site-packages/stackstac/prepare.py:408: UserWarning: The argument 'infer_datetime_format' is deprecated and will be removed in a future version. A strict version of it is now the default, see https://pandas.pydata.org/pdeps/0004-consistent-to-datetime-parsing.html. You can safely remove this argument.
  times = pd.to_datetime(</code></pre>
</div>
</div>
<div id="61a5e27c" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out scenes with &gt;15% cloud coverage (according to the eo:cloud_cover field). </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Then, pick the bands corresponding to red, green, and blue, and use xarray’s resample to create 1-month median composites.</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>lowcloud <span class="op">=</span> stack[stack[<span class="st">"eo:cloud_cover"</span>] <span class="op">&lt;</span> <span class="dv">15</span>]</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>rgb <span class="op">=</span> lowcloud.sel(band<span class="op">=</span>[<span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>])</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>monthly <span class="op">=</span> rgb.resample(time<span class="op">=</span><span class="st">"MS"</span>).median(<span class="st">"time"</span>, keep_attrs<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/al/miniforge3/envs/eodh/lib/python3.12/site-packages/dask/array/core.py:4832: PerformanceWarning: Increasing number of chunks by factor of 11
  result = blockwise(
/home/al/miniforge3/envs/eodh/lib/python3.12/site-packages/dask/array/core.py:4832: PerformanceWarning: Increasing number of chunks by factor of 11
  result = blockwise(</code></pre>
</div>
</div>
<div id="4c551c9a" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we don't want all the data so we slice out a little region around our area of interest.</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert our lat-lon point to the data’s coordinate reference system, then use that to slice the x and y dimensions.</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>x_utm, y_utm <span class="op">=</span> pyproj.Proj(monthly.crs)(lon, lat)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="bu">buffer</span> <span class="op">=</span> <span class="dv">500</span>  <span class="co"># meters</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>aoi <span class="op">=</span> monthly.loc[..., y_utm<span class="op">+</span><span class="bu">buffer</span>:y_utm<span class="op">-</span><span class="bu">buffer</span>, x_utm<span class="op">-</span><span class="bu">buffer</span>:x_utm<span class="op">+</span><span class="bu">buffer</span>]</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>aoi</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.DataArray 'stackstac-1b700e7881038b247c2b451c3e1547c4' (time: 7,
                                                                band: 3,
                                                                y: 100, x: 100)&gt; Size: 2MB
dask.array&lt;getitem, shape=(7, 3, 100, 100), dtype=float64, chunksize=(3, 1, 100, 100), chunktype=numpy.ndarray&gt;
Coordinates: (12/23)
  * band                                     (band) &lt;U12 144B 'red' ... 'blue'
  * x                                        (x) float64 800B 6.163e+05 ... 6...
  * y                                        (y) float64 800B 5.716e+06 ... 5...
  * time                                     (time) datetime64[ns] 56B 2023-0...
    s2:datatake_type                         &lt;U8 32B 'INS-NOBS'
    mgrs:latitude_band                       &lt;U1 4B 'U'
    ...                                       ...
    raster:bands                             (band) object 24B [{'nodata': 0,...
    gsd                                      (band) object 24B 10 10 10
    common_name                              (band) object 24B 'red' ... 'blue'
    center_wavelength                        (band) object 24B 0.665 0.56 0.49
    full_width_half_max                      (band) object 24B 0.038 0.045 0.098
    epsg                                     int64 8B 32630
Attributes:
    spec:        RasterSpec(epsg=32630, bounds=(600000.0, 5690220.0, 709800.0...
    crs:         epsg:32630
    transform:   | 10.00, 0.00, 600000.00|\n| 0.00,-10.00, 5800020.00|\n| 0.0...
    resolution:  10.0</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.DataArray</div><div class="xr-array-name">'stackstac-1b700e7881038b247c2b451c3e1547c4'</div><ul class="xr-dim-list"><li><span class="xr-has-index">time</span>: 7</li><li><span class="xr-has-index">band</span>: 3</li><li><span class="xr-has-index">y</span>: 100</li><li><span class="xr-has-index">x</span>: 100</li></ul></div><ul class="xr-sections"><li class="xr-section-item"><div class="xr-array-wrap"><input id="section-ce7a47d7-0b5b-4d52-ad6d-9a4063ad2ed8" class="xr-array-in" type="checkbox" checked=""><label for="section-ce7a47d7-0b5b-4d52-ad6d-9a4063ad2ed8" title="Show/hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-array-preview xr-preview"><span>dask.array&lt;chunksize=(1, 1, 100, 100), meta=np.ndarray&gt;</span></div><div class="xr-array-data">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th></th>
<th data-quarto-table-cell-role="th">Array</th>
<th data-quarto-table-cell-role="th">Chunk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Bytes</td>
<td>1.60 MiB</td>
<td>234.38 kiB</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Shape</td>
<td>(7, 3, 100, 100)</td>
<td>(3, 1, 100, 100)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dask graph</td>
<td colspan="2">12 chunks in 35 graph layers</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Data type</td>
<td colspan="2">float64 numpy.ndarray</td>
</tr>
</tbody>
</table></td>
<td><svg width="400" height="188" style="stroke:rgb(0,0,0);stroke-width:1">
<!-- Horizontal lines --> <line x1="0" y1="0" x2="36" y2="0" style="stroke-width:2"></line> <line x1="0" y1="25" x2="36" y2="25" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2"></line> <line x1="5" y1="0" x2="5" y2="25"></line> <line x1="20" y1="0" x2="20" y2="25"></line> <line x1="31" y1="0" x2="31" y2="25"></line> <line x1="36" y1="0" x2="36" y2="25" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="0.0,0.0 36.539375515867995,0.0 36.539375515867995,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Text --> <text x="18.269688" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle">7</text> <text x="56.539376" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,56.539376,12.706308)">1</text> <!-- Horizontal lines --> <line x1="106" y1="0" x2="124" y2="18" style="stroke-width:2"></line> <line x1="106" y1="120" x2="124" y2="138" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="106" y1="0" x2="106" y2="120" style="stroke-width:2"></line> <line x1="112" y1="6" x2="112" y2="126"></line> <line x1="118" y1="12" x2="118" y2="132"></line> <line x1="124" y1="18" x2="124" y2="138" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="106.0,0.0 124.46492855066211,18.46492855066211 124.46492855066211,138.4649285506621 106.0,120.0" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="106" y1="0" x2="226" y2="0" style="stroke-width:2"></line> <line x1="112" y1="6" x2="232" y2="6"></line> <line x1="118" y1="12" x2="238" y2="12"></line> <line x1="124" y1="18" x2="244" y2="18" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="106" y1="0" x2="124" y2="18" style="stroke-width:2"></line> <line x1="226" y1="0" x2="244" y2="18" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="106.0,0.0 226.0,0.0 244.4649285506621,18.46492855066211 124.46492855066211,18.46492855066211" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="124" y1="18" x2="244" y2="18" style="stroke-width:2"></line> <line x1="124" y1="138" x2="244" y2="138" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="124" y1="18" x2="124" y2="138" style="stroke-width:2"></line> <line x1="244" y1="18" x2="244" y2="138" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="124.46492855066211,18.46492855066211 244.4649285506621,18.46492855066211 244.4649285506621,138.4649285506621 124.46492855066211,138.4649285506621" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Text --> <text x="184.464929" y="158.464929" font-size="1.0rem" font-weight="100" text-anchor="middle">100</text> <text x="264.464929" y="78.464929" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,264.464929,78.464929)">100</text> <text x="105.232464" y="149.232464" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,105.232464,149.232464)">3</text>
</svg></td>
</tr>
</tbody>
</table>
</div></div></li><li class="xr-section-item"><input id="section-122b3bd6-d04f-41df-9ad9-7dce7e7d5a30" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-122b3bd6-d04f-41df-9ad9-7dce7e7d5a30" class="xr-section-summary">Coordinates: <span>(23)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">band</span></div><div class="xr-var-dims">(band)</div><div class="xr-var-dtype">&lt;U12</div><div class="xr-var-preview xr-preview">'red' 'green' 'blue'</div><input id="attrs-1ca4c4e8-2d98-4de6-b43e-8a50f33d0c01" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-1ca4c4e8-2d98-4de6-b43e-8a50f33d0c01" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-858bfc3e-3720-47b6-ab31-c52eb779a67b" class="xr-var-data-in" type="checkbox"><label for="data-858bfc3e-3720-47b6-ab31-c52eb779a67b" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array(['red', 'green', 'blue'], dtype='&lt;U12')</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">x</span></div><div class="xr-var-dims">(x)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">6.163e+05 6.163e+05 ... 6.173e+05</div><input id="attrs-1680bad0-1f2d-4de8-8f28-9a47cc8cac0f" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-1680bad0-1f2d-4de8-8f28-9a47cc8cac0f" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-92691dd2-eb35-4869-88db-9b32053e6e31" class="xr-var-data-in" type="checkbox"><label for="data-92691dd2-eb35-4869-88db-9b32053e6e31" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([616310., 616320., 616330., 616340., 616350., 616360., 616370., 616380.,
       616390., 616400., 616410., 616420., 616430., 616440., 616450., 616460.,
       616470., 616480., 616490., 616500., 616510., 616520., 616530., 616540.,
       616550., 616560., 616570., 616580., 616590., 616600., 616610., 616620.,
       616630., 616640., 616650., 616660., 616670., 616680., 616690., 616700.,
       616710., 616720., 616730., 616740., 616750., 616760., 616770., 616780.,
       616790., 616800., 616810., 616820., 616830., 616840., 616850., 616860.,
       616870., 616880., 616890., 616900., 616910., 616920., 616930., 616940.,
       616950., 616960., 616970., 616980., 616990., 617000., 617010., 617020.,
       617030., 617040., 617050., 617060., 617070., 617080., 617090., 617100.,
       617110., 617120., 617130., 617140., 617150., 617160., 617170., 617180.,
       617190., 617200., 617210., 617220., 617230., 617240., 617250., 617260.,
       617270., 617280., 617290., 617300.])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">y</span></div><div class="xr-var-dims">(y)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">5.716e+06 5.716e+06 ... 5.715e+06</div><input id="attrs-d1876a67-ff12-4973-a07c-ef30e5534dfd" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-d1876a67-ff12-4973-a07c-ef30e5534dfd" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-8c0eace8-885d-469e-92a8-c7a0c1fa461e" class="xr-var-data-in" type="checkbox"><label for="data-8c0eace8-885d-469e-92a8-c7a0c1fa461e" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([5715670., 5715660., 5715650., 5715640., 5715630., 5715620., 5715610.,
       5715600., 5715590., 5715580., 5715570., 5715560., 5715550., 5715540.,
       5715530., 5715520., 5715510., 5715500., 5715490., 5715480., 5715470.,
       5715460., 5715450., 5715440., 5715430., 5715420., 5715410., 5715400.,
       5715390., 5715380., 5715370., 5715360., 5715350., 5715340., 5715330.,
       5715320., 5715310., 5715300., 5715290., 5715280., 5715270., 5715260.,
       5715250., 5715240., 5715230., 5715220., 5715210., 5715200., 5715190.,
       5715180., 5715170., 5715160., 5715150., 5715140., 5715130., 5715120.,
       5715110., 5715100., 5715090., 5715080., 5715070., 5715060., 5715050.,
       5715040., 5715030., 5715020., 5715010., 5715000., 5714990., 5714980.,
       5714970., 5714960., 5714950., 5714940., 5714930., 5714920., 5714910.,
       5714900., 5714890., 5714880., 5714870., 5714860., 5714850., 5714840.,
       5714830., 5714820., 5714810., 5714800., 5714790., 5714780., 5714770.,
       5714760., 5714750., 5714740., 5714730., 5714720., 5714710., 5714700.,
       5714690., 5714680.])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">time</span></div><div class="xr-var-dims">(time)</div><div class="xr-var-dtype">datetime64[ns]</div><div class="xr-var-preview xr-preview">2023-05-01 ... 2023-11-01</div><input id="attrs-5c6da5ad-0dc6-4160-8259-47386650ed37" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-5c6da5ad-0dc6-4160-8259-47386650ed37" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-7e4a8f84-ff3e-401f-b7de-31040f81ee98" class="xr-var-data-in" type="checkbox"><label for="data-7e4a8f84-ff3e-401f-b7de-31040f81ee98" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array(['2023-05-01T00:00:00.000000000', '2023-06-01T00:00:00.000000000',
       '2023-07-01T00:00:00.000000000', '2023-08-01T00:00:00.000000000',
       '2023-09-01T00:00:00.000000000', '2023-10-01T00:00:00.000000000',
       '2023-11-01T00:00:00.000000000'], dtype='datetime64[ns]')</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>s2:datatake_type</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">&lt;U8</div><div class="xr-var-preview xr-preview">'INS-NOBS'</div><input id="attrs-5771d2f8-6005-4b3e-83a6-b54ff64124f4" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-5771d2f8-6005-4b3e-83a6-b54ff64124f4" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-5e9549d3-f790-4188-920a-ef7afa817801" class="xr-var-data-in" type="checkbox"><label for="data-5e9549d3-f790-4188-920a-ef7afa817801" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array('INS-NOBS', dtype='&lt;U8')</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>mgrs:latitude_band</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">&lt;U1</div><div class="xr-var-preview xr-preview">'U'</div><input id="attrs-136190da-9d1c-4b6a-873d-abca8706559f" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-136190da-9d1c-4b6a-873d-abca8706559f" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-475beedc-56c9-47aa-83e8-52c6107f71fb" class="xr-var-data-in" type="checkbox"><label for="data-475beedc-56c9-47aa-83e8-52c6107f71fb" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array('U', dtype='&lt;U1')</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>instruments</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">&lt;U3</div><div class="xr-var-preview xr-preview">'msi'</div><input id="attrs-5dbfbaf0-28df-42f7-a379-04a56de17faa" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-5dbfbaf0-28df-42f7-a379-04a56de17faa" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-4ad2c016-3958-4d80-89c1-ae2b1addeaca" class="xr-var-data-in" type="checkbox"><label for="data-4ad2c016-3958-4d80-89c1-ae2b1addeaca" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array('msi', dtype='&lt;U3')</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>grid:code</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">&lt;U10</div><div class="xr-var-preview xr-preview">'MGRS-30UXC'</div><input id="attrs-ea5704cb-0cf6-4a45-9052-9f7c28ae912c" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-ea5704cb-0cf6-4a45-9052-9f7c28ae912c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-a307230a-5071-4a8f-8d56-c4fe3281c478" class="xr-var-data-in" type="checkbox"><label for="data-a307230a-5071-4a8f-8d56-c4fe3281c478" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array('MGRS-30UXC', dtype='&lt;U10')</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>s2:saturated_defective_pixel_percentage</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0</div><input id="attrs-c20b5885-5bc3-4c68-aab4-a03851df019f" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-c20b5885-5bc3-4c68-aab4-a03851df019f" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-8bb54073-4ac5-4aee-87ab-394f8133ed5e" class="xr-var-data-in" type="checkbox"><label for="data-8bb54073-4ac5-4aee-87ab-394f8133ed5e" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array(0)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>constellation</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">&lt;U10</div><div class="xr-var-preview xr-preview">'sentinel-2'</div><input id="attrs-ad4f7c7d-62d9-4c67-9d70-aa1ff5029b69" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-ad4f7c7d-62d9-4c67-9d70-aa1ff5029b69" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-4c7c2314-951a-4390-a3e7-9f18abb21a7f" class="xr-var-data-in" type="checkbox"><label for="data-4c7c2314-951a-4390-a3e7-9f18abb21a7f" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array('sentinel-2', dtype='&lt;U10')</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>earthsearch:boa_offset_applied</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">bool</div><div class="xr-var-preview xr-preview">True</div><input id="attrs-104cb20d-c09f-4caf-91c8-7829f3846e07" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-104cb20d-c09f-4caf-91c8-7829f3846e07" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-b5102140-a3a4-4b4b-a69d-0f9e2ac3b618" class="xr-var-data-in" type="checkbox"><label for="data-b5102140-a3a4-4b4b-a69d-0f9e2ac3b618" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array(True)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>s2:product_type</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">&lt;U7</div><div class="xr-var-preview xr-preview">'S2MSI2A'</div><input id="attrs-1bd2d1aa-2464-4bf8-97c1-6df4394c66cd" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-1bd2d1aa-2464-4bf8-97c1-6df4394c66cd" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-d18bc5b4-c8d8-4f4c-b2bc-d9b2ee8206e2" class="xr-var-data-in" type="checkbox"><label for="data-d18bc5b4-c8d8-4f4c-b2bc-d9b2ee8206e2" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array('S2MSI2A', dtype='&lt;U7')</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>mgrs:utm_zone</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">30</div><input id="attrs-ffd06d2b-62e8-453f-b20f-b9efedc8410a" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-ffd06d2b-62e8-453f-b20f-b9efedc8410a" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-c8dd29e1-ab5e-465e-aae0-3d4579291ee5" class="xr-var-data-in" type="checkbox"><label for="data-c8dd29e1-ab5e-465e-aae0-3d4579291ee5" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array(30)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>s2:processing_baseline</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">&lt;U5</div><div class="xr-var-preview xr-preview">'05.09'</div><input id="attrs-d8816ddf-e7f0-4f98-a889-a9c4cb8fadb0" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-d8816ddf-e7f0-4f98-a889-a9c4cb8fadb0" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-9d9f765a-1186-4eba-b14e-40106fd6898c" class="xr-var-data-in" type="checkbox"><label for="data-9d9f765a-1186-4eba-b14e-40106fd6898c" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array('05.09', dtype='&lt;U5')</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>proj:epsg</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">32630</div><input id="attrs-f06542ea-f4f3-415d-aba1-a552a5f66fcb" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-f06542ea-f4f3-415d-aba1-a552a5f66fcb" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-6612b0b1-e3a8-41d0-bb18-cb6e9fcaf7cc" class="xr-var-data-in" type="checkbox"><label for="data-6612b0b1-e3a8-41d0-bb18-cb6e9fcaf7cc" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array(32630)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>mgrs:grid_square</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">&lt;U2</div><div class="xr-var-preview xr-preview">'XC'</div><input id="attrs-b72d4c5d-dbbb-47c7-96db-1659be81dc4f" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-b72d4c5d-dbbb-47c7-96db-1659be81dc4f" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-23e61638-1e12-4125-8966-bcdb258e9a1f" class="xr-var-data-in" type="checkbox"><label for="data-23e61638-1e12-4125-8966-bcdb258e9a1f" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array('XC', dtype='&lt;U2')</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>title</span></div><div class="xr-var-dims">(band)</div><div class="xr-var-dtype">&lt;U31</div><div class="xr-var-preview xr-preview">'Red (band 4) - 10m' ... 'Blue (...</div><input id="attrs-8e1b6d2c-0a6a-48b8-b147-d65b92535079" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-8e1b6d2c-0a6a-48b8-b147-d65b92535079" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-af7c26fe-9292-4c41-bb37-82980073e8b8" class="xr-var-data-in" type="checkbox"><label for="data-af7c26fe-9292-4c41-bb37-82980073e8b8" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array(['Red (band 4) - 10m', 'Green (band 3) - 10m',
       'Blue (band 2) - 10m'], dtype='&lt;U31')</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>raster:bands</span></div><div class="xr-var-dims">(band)</div><div class="xr-var-dtype">object</div><div class="xr-var-preview xr-preview">[{'nodata': 0, 'data_type': 'uin...</div><input id="attrs-8323e0a1-8c7c-4649-8d06-9dc2dd817481" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-8323e0a1-8c7c-4649-8d06-9dc2dd817481" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-da36bd16-5da2-4c7d-ab26-09d126a8cc85" class="xr-var-data-in" type="checkbox"><label for="data-da36bd16-5da2-4c7d-ab26-09d126a8cc85" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([list([{'nodata': 0, 'data_type': 'uint16', 'bits_per_sample': 15, 'spatial_resolution': 10, 'scale': 0.0001, 'offset': -0.1}]),
       list([{'nodata': 0, 'data_type': 'uint16', 'bits_per_sample': 15, 'spatial_resolution': 10, 'scale': 0.0001, 'offset': -0.1}]),
       list([{'nodata': 0, 'data_type': 'uint16', 'bits_per_sample': 15, 'spatial_resolution': 10, 'scale': 0.0001, 'offset': -0.1}])],
      dtype=object)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>gsd</span></div><div class="xr-var-dims">(band)</div><div class="xr-var-dtype">object</div><div class="xr-var-preview xr-preview">10 10 10</div><input id="attrs-8262b26e-8cfb-4f4f-b376-b315a4ee4389" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-8262b26e-8cfb-4f4f-b376-b315a4ee4389" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-2cd43271-6064-4ecb-8c39-2ccef57ff112" class="xr-var-data-in" type="checkbox"><label for="data-2cd43271-6064-4ecb-8c39-2ccef57ff112" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([10, 10, 10], dtype=object)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>common_name</span></div><div class="xr-var-dims">(band)</div><div class="xr-var-dtype">object</div><div class="xr-var-preview xr-preview">'red' 'green' 'blue'</div><input id="attrs-64185cd7-5574-4edb-a839-29d3eda6d249" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-64185cd7-5574-4edb-a839-29d3eda6d249" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-83c02be7-bbd4-4268-88e2-00924733f85e" class="xr-var-data-in" type="checkbox"><label for="data-83c02be7-bbd4-4268-88e2-00924733f85e" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array(['red', 'green', 'blue'], dtype=object)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>center_wavelength</span></div><div class="xr-var-dims">(band)</div><div class="xr-var-dtype">object</div><div class="xr-var-preview xr-preview">0.665 0.56 0.49</div><input id="attrs-a3e7c4e2-1ae0-4f22-9404-434a8cbfeece" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-a3e7c4e2-1ae0-4f22-9404-434a8cbfeece" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-f02ab4d8-c88e-4bc2-9ac9-dbaf958ef35e" class="xr-var-data-in" type="checkbox"><label for="data-f02ab4d8-c88e-4bc2-9ac9-dbaf958ef35e" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0.665, 0.56, 0.49], dtype=object)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>full_width_half_max</span></div><div class="xr-var-dims">(band)</div><div class="xr-var-dtype">object</div><div class="xr-var-preview xr-preview">0.038 0.045 0.098</div><input id="attrs-bc805e36-3d9e-4d48-b043-a54200467a90" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-bc805e36-3d9e-4d48-b043-a54200467a90" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-29cceb92-3118-4b88-ba29-a5a29df2c35e" class="xr-var-data-in" type="checkbox"><label for="data-29cceb92-3118-4b88-ba29-a5a29df2c35e" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0.038, 0.045, 0.098], dtype=object)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>epsg</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">32630</div><input id="attrs-008f1f04-d48d-4a9d-af16-a46dfe3d48cf" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-008f1f04-d48d-4a9d-af16-a46dfe3d48cf" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-c3089218-ff7b-4d3a-9c6a-0a46774ef42f" class="xr-var-data-in" type="checkbox"><label for="data-c3089218-ff7b-4d3a-9c6a-0a46774ef42f" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array(32630)</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-6d458c73-ca8b-4ee6-9e3c-228203cd3a22" class="xr-section-summary-in" type="checkbox"><label for="section-6d458c73-ca8b-4ee6-9e3c-228203cd3a22" class="xr-section-summary">Indexes: <span>(4)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>band</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-bc3869ea-3a40-4873-8af2-06b407fdfad3" class="xr-index-data-in" type="checkbox"><label for="index-bc3869ea-3a40-4873-8af2-06b407fdfad3" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index(['red', 'green', 'blue'], dtype='object', name='band'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>x</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-b32698a9-103a-4f2d-ba42-a85465bb4410" class="xr-index-data-in" type="checkbox"><label for="index-b32698a9-103a-4f2d-ba42-a85465bb4410" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([616310.0, 616320.0, 616330.0, 616340.0, 616350.0, 616360.0, 616370.0,
       616380.0, 616390.0, 616400.0, 616410.0, 616420.0, 616430.0, 616440.0,
       616450.0, 616460.0, 616470.0, 616480.0, 616490.0, 616500.0, 616510.0,
       616520.0, 616530.0, 616540.0, 616550.0, 616560.0, 616570.0, 616580.0,
       616590.0, 616600.0, 616610.0, 616620.0, 616630.0, 616640.0, 616650.0,
       616660.0, 616670.0, 616680.0, 616690.0, 616700.0, 616710.0, 616720.0,
       616730.0, 616740.0, 616750.0, 616760.0, 616770.0, 616780.0, 616790.0,
       616800.0, 616810.0, 616820.0, 616830.0, 616840.0, 616850.0, 616860.0,
       616870.0, 616880.0, 616890.0, 616900.0, 616910.0, 616920.0, 616930.0,
       616940.0, 616950.0, 616960.0, 616970.0, 616980.0, 616990.0, 617000.0,
       617010.0, 617020.0, 617030.0, 617040.0, 617050.0, 617060.0, 617070.0,
       617080.0, 617090.0, 617100.0, 617110.0, 617120.0, 617130.0, 617140.0,
       617150.0, 617160.0, 617170.0, 617180.0, 617190.0, 617200.0, 617210.0,
       617220.0, 617230.0, 617240.0, 617250.0, 617260.0, 617270.0, 617280.0,
       617290.0, 617300.0],
      dtype='float64', name='x'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>y</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-3a208e01-8bba-4530-aad7-8070a74613e5" class="xr-index-data-in" type="checkbox"><label for="index-3a208e01-8bba-4530-aad7-8070a74613e5" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([5715670.0, 5715660.0, 5715650.0, 5715640.0, 5715630.0, 5715620.0,
       5715610.0, 5715600.0, 5715590.0, 5715580.0, 5715570.0, 5715560.0,
       5715550.0, 5715540.0, 5715530.0, 5715520.0, 5715510.0, 5715500.0,
       5715490.0, 5715480.0, 5715470.0, 5715460.0, 5715450.0, 5715440.0,
       5715430.0, 5715420.0, 5715410.0, 5715400.0, 5715390.0, 5715380.0,
       5715370.0, 5715360.0, 5715350.0, 5715340.0, 5715330.0, 5715320.0,
       5715310.0, 5715300.0, 5715290.0, 5715280.0, 5715270.0, 5715260.0,
       5715250.0, 5715240.0, 5715230.0, 5715220.0, 5715210.0, 5715200.0,
       5715190.0, 5715180.0, 5715170.0, 5715160.0, 5715150.0, 5715140.0,
       5715130.0, 5715120.0, 5715110.0, 5715100.0, 5715090.0, 5715080.0,
       5715070.0, 5715060.0, 5715050.0, 5715040.0, 5715030.0, 5715020.0,
       5715010.0, 5715000.0, 5714990.0, 5714980.0, 5714970.0, 5714960.0,
       5714950.0, 5714940.0, 5714930.0, 5714920.0, 5714910.0, 5714900.0,
       5714890.0, 5714880.0, 5714870.0, 5714860.0, 5714850.0, 5714840.0,
       5714830.0, 5714820.0, 5714810.0, 5714800.0, 5714790.0, 5714780.0,
       5714770.0, 5714760.0, 5714750.0, 5714740.0, 5714730.0, 5714720.0,
       5714710.0, 5714700.0, 5714690.0, 5714680.0],
      dtype='float64', name='y'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>time</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-9080efb2-0112-47d6-9dce-4f95b4f9e0b2" class="xr-index-data-in" type="checkbox"><label for="index-9080efb2-0112-47d6-9dce-4f95b4f9e0b2" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(DatetimeIndex(['2023-05-01', '2023-06-01', '2023-07-01', '2023-08-01',
               '2023-09-01', '2023-10-01', '2023-11-01'],
              dtype='datetime64[ns]', name='time', freq='MS'))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-10d769ff-a513-437a-9326-280382aea17c" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-10d769ff-a513-437a-9326-280382aea17c" class="xr-section-summary">Attributes: <span>(4)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>spec :</span></dt><dd>RasterSpec(epsg=32630, bounds=(600000.0, 5690220.0, 709800.0, 5800020.0), resolutions_xy=(10.0, 10.0))</dd><dt><span>crs :</span></dt><dd>epsg:32630</dd><dt><span>transform :</span></dt><dd>| 10.00, 0.00, 600000.00|
| 0.00,-10.00, 5800020.00|
| 0.00, 0.00, 1.00|</dd><dt><span>resolution :</span></dt><dd>10.0</dd></dl></div></li></ul></div></div>
</div>
</div>
<div id="85e3125d" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> dask.diagnostics.ProgressBar():</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> aoi.compute()</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># show the monthly composites where they exist</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>data.plot.imshow(row<span class="op">=</span><span class="st">"time"</span>, rgb<span class="op">=</span><span class="st">"band"</span>, robust<span class="op">=</span><span class="va">True</span>, size<span class="op">=</span><span class="dv">4</span>, col_wrap<span class="op">=</span><span class="dv">3</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[########################################] | 100% Completed | 43.78 s</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/al/miniforge3/envs/eodh/lib/python3.12/site-packages/matplotlib/cm.py:494: RuntimeWarning: invalid value encountered in cast
  xx = (xx * 255).astype(np.uint8)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="cubes_files/figure-html/cell-8-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>This means we can be confident that this works for the Element 84 Sentinel data - blank plots are where there are not enough cloud free images in a month to create the composites.</p>
</section>
<section id="stackstac-and-ceda-stac" class="level1">
<h1>STACKSTAC and CEDA STAC</h1>
<p>This next series of cells tries to replicate the processing process above (i.e.&nbsp;using stackstac) but with the CEDA S2 ARD catalogue</p>
<div id="23da85ea" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Connect and search STAC catalogue</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ccatalog <span class="op">=</span> Client.<span class="bu">open</span>(CURL)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>citems <span class="op">=</span> ccatalog.search(</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    intersects<span class="op">=</span><span class="bu">dict</span>(<span class="bu">type</span><span class="op">=</span><span class="st">"Point"</span>, coordinates<span class="op">=</span>[lon, lat]),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    collections<span class="op">=</span>[<span class="st">"sentinel2_ard"</span>],</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    datetime<span class="op">=</span><span class="st">"2023-05-01/2023-11-30"</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>).item_collection()</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(citems)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>40</code></pre>
</div>
</div>
<div id="fdfb8fef" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mystack <span class="op">=</span> stackstac.stack(citems)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/al/miniforge3/envs/eodh/lib/python3.12/site-packages/stackstac/prepare.py:103: UserWarning: You're filtering for assets that match the mimetype(s) frozenset({'image/jp2', 'image/tiff', 'image/vnd.stac.geotiff', 'image/x.geotiff'}), but since 8 (out of 8) asset(s) have no `type` specified on any item, those will be dropped. Consider passing a list of asset IDs instead to the `assets=` parameter.
Assets with no type: ['cloud', 'cloud_probability', 'metadata', 'thumbnail', 'topographic_shadow', 'cog', 'valid_pixels', 'saturated_pixels']
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[11], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> mystack <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">stackstac</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">stack</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">citems</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/miniforge3/envs/eodh/lib/python3.12/site-packages/stackstac/stack.py:290</span>, in <span class="ansi-cyan-fg">stack</span><span class="ansi-blue-fg">(items, assets, epsg, resolution, bounds, bounds_latlon, snap_bounds, resampling, chunksize, dtype, fill_value, rescale, sortby_date, xy_coords, properties, band_coords, gdal_env, errors_as_nodata, reader)</span>
<span class="ansi-green-fg ansi-bold">    283</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> sortby_date <span style="font-weight:bold;color:rgb(175,0,255)">is</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> <span style="font-weight:bold;color:rgb(0,135,0)">False</span>:
<span class="ansi-green-fg ansi-bold">    284</span>     plain_items <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">sorted</span>(
<span class="ansi-green-fg ansi-bold">    285</span>         plain_items,
<span class="ansi-green-fg ansi-bold">    286</span>         key<span style="color:rgb(98,98,98)">=</span><span style="font-weight:bold;color:rgb(0,135,0)">lambda</span> item: item[<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">properties</span><span style="color:rgb(175,0,0)">"</span>]<span style="color:rgb(98,98,98)">.</span>get(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">datetime</span><span style="color:rgb(175,0,0)">"</span>, <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">"</span>) <span style="font-weight:bold;color:rgb(175,0,255)">or</span> <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">"</span>,
<span class="ansi-green-fg ansi-bold">    287</span>         reverse<span style="color:rgb(98,98,98)">=</span>sortby_date <span style="color:rgb(98,98,98)">==</span> <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">desc</span><span style="color:rgb(175,0,0)">"</span>,
<span class="ansi-green-fg ansi-bold">    288</span>     )
<span class="ansi-green-fg">--&gt; 290</span> asset_table, spec, asset_ids, plain_items <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">prepare_items</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg ansi-bold">    291</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">plain_items</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    292</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">assets</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">assets</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    293</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">epsg</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">epsg</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    294</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">resolution</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">resolution</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    295</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">bounds</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">bounds</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    296</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">bounds_latlon</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">bounds_latlon</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    297</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">snap_bounds</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">snap_bounds</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    298</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">rescale</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">rescale</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    299</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">dtype</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">dtype</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg ansi-bold">    300</span> <span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    301</span> arr <span style="color:rgb(98,98,98)">=</span> items_to_dask(
<span class="ansi-green-fg ansi-bold">    302</span>     asset_table,
<span class="ansi-green-fg ansi-bold">    303</span>     spec,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">    311</span>     errors_as_nodata<span style="color:rgb(98,98,98)">=</span>errors_as_nodata,
<span class="ansi-green-fg ansi-bold">    312</span> )
<span class="ansi-green-fg ansi-bold">    314</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> xr<span style="color:rgb(98,98,98)">.</span>DataArray(
<span class="ansi-green-fg ansi-bold">    315</span>     arr,
<span class="ansi-green-fg ansi-bold">    316</span>     <span style="color:rgb(98,98,98)">*</span>to_coords(
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">    325</span>     name<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">stackstac-</span><span style="color:rgb(175,0,0)">"</span> <span style="color:rgb(98,98,98)">+</span> dask<span style="color:rgb(98,98,98)">.</span>base<span style="color:rgb(98,98,98)">.</span>tokenize(arr),
<span class="ansi-green-fg ansi-bold">    326</span> )

File <span class="ansi-green-fg">~/miniforge3/envs/eodh/lib/python3.12/site-packages/stackstac/prepare.py:132</span>, in <span class="ansi-cyan-fg">prepare_items</span><span class="ansi-blue-fg">(items, assets, epsg, resolution, bounds, bounds_latlon, snap_bounds, rescale, dtype)</span>
<span class="ansi-green-fg ansi-bold">    130</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> <span style="font-weight:bold;color:rgb(215,95,95)">ValueError</span>(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">No items</span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg ansi-bold">    131</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="color:rgb(0,135,0)">len</span>(asset_ids) <span style="color:rgb(98,98,98)">==</span> <span style="color:rgb(98,98,98)">0</span>:
<span class="ansi-green-fg">--&gt; 132</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> <span style="font-weight:bold;color:rgb(215,95,95)">ValueError</span>(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Zero asset IDs requested</span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg ansi-bold">    134</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> item_i, item <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="color:rgb(0,135,0)">enumerate</span>(items):
<span class="ansi-green-fg ansi-bold">    135</span>     item_epsg <span style="color:rgb(98,98,98)">=</span> item[<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">properties</span><span style="color:rgb(175,0,0)">"</span>]<span style="color:rgb(98,98,98)">.</span>get(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">proj:epsg</span><span style="color:rgb(175,0,0)">"</span>)

<span class="ansi-red-fg">ValueError</span>: Zero asset IDs requested</pre>
</div>
</div>
</div>
<p>This doesn’t work out of the box. There are a number of arguements that we can look at: https://stackstac.readthedocs.io/en/latest/api/main/stackstac.stack.html</p>
<div id="72e66405" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mystack <span class="op">=</span> stackstac.stack(citems, assets<span class="op">=</span>citems.extra_fields[<span class="st">'eo.bands'</span>], epsg<span class="op">=</span><span class="dv">27700</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[12], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> mystack <span style="color:rgb(98,98,98)">=</span> stackstac<span style="color:rgb(98,98,98)">.</span>stack(citems, assets<span style="color:rgb(98,98,98)">=</span><span class="ansi-yellow-bg">citems</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">extra_fields</span><span class="ansi-yellow-bg">[</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">'</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">eo.bands</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">'</span><span class="ansi-yellow-bg">]</span>, epsg<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(98,98,98)">27700</span>)

<span class="ansi-red-fg">KeyError</span>: 'eo.bands'</pre>
</div>
</div>
</div>
<p>Somewhere my referencing isn’t correct. So we should have a look at where the various information resides. My understanding is that we would need to reference the <code>cog.href</code> and then the bands from there</p>
<div id="d82a769d" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure we know that the bands are discoverable</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Pick the first item to inspect the assets</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>item <span class="op">=</span> citems[<span class="dv">0</span>]</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect assets in the item</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> asset_key, asset <span class="kw">in</span> item.assets.items():</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Asset: </span><span class="sc">{</span>asset_key<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if the asset has eo:bands metadata</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'eo:bands'</span> <span class="kw">in</span> asset.extra_fields:</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>        bands <span class="op">=</span> asset.extra_fields[<span class="st">'eo:bands'</span>]</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> band <span class="kw">in</span> bands:</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Band: </span><span class="sc">{</span>band[<span class="st">'name'</span>]<span class="sc">}</span><span class="ss"> - </span><span class="sc">{</span>band[<span class="st">'description'</span>]<span class="sc">}</span><span class="ss"> - </span><span class="sc">{</span>band[<span class="st">'common_name'</span>]<span class="sc">}</span><span class="ss"> "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Asset: cloud
Asset: cloud_probability
Asset: metadata
Asset: thumbnail
Asset: topographic_shadow
Asset: cog
Band: B02 - Blue - blue 
Band: B03 - Green - green 
Band: B04 - Red - red 
Band: B05 - Visible and Near Infrared - rededge 
Band: B06 - Visible and Near Infrared - rededge 
Band: B07 - Visible and Near Infrared - rededge 
Band: B08 - Visible and Near Infrared - nir 
Band: B08a - Visible and Near Infrared - nir08 
Band: B11 - Short Wave Infrared - swir16 
Band: B12 - Short Wave Infrared - swir22 
Asset: valid_pixels
Asset: saturated_pixels</code></pre>
</div>
</div>
<p>So we know that we can see the band information held in <code>eo:bands</code>, and that the asset is <code>cog</code> which has an associated url to the tif.</p>
<p>Let’s compare items with citems and see how the structure differs</p>
<div id="3da7b468" class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>items[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="ef122635" class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>citems[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e2f0fc70" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sense check that I can see the information I need to </span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>stac_item <span class="op">=</span> citems[<span class="dv">1</span>]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stac_item.assets[<span class="st">'cog'</span>].href)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>stac_item.assets[<span class="st">'cog'</span>].extra_fields[<span class="st">'eo:bands'</span>][<span class="dv">1</span>][<span class="st">'name'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>https://dap.ceda.ac.uk/neodc/sentinel_ard/data/sentinel_2/2023/11/17/S2A_20231117_latn518lonw0008_T30UXC_ORB137_20231117131218_utm30n_osgb_vmsk_sharp_rad_srefdem_stdsref.tif</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>'B03'</code></pre>
</div>
</div>
<p>There is some interesting information here: https://github.com/stac-extensions/eo?tab=readme-ov-file#spectral-bands</p>
</section>
<section id="workaround" class="level1">
<h1>Workaround?</h1>
<p>Basically we just want to be able to create an xarray object from the individual bands held in the CEDA STAC catalogue.</p>
<div id="c37d5445" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rioxarray</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Access the URL for an individual CEDA STAC asset to test opening it using rioxarray</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>datafile <span class="op">=</span> stac_item.assets[<span class="st">'cog'</span>].href</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>rds <span class="op">=</span> rioxarray.open_rasterio(datafile, overview_level<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>rds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.DataArray (band: 10, y: 695, x: 695)&gt; Size: 10MB
[4830250 values with dtype=uint16]
Coordinates:
  * band         (band) int64 80B 1 2 3 4 5 6 7 8 9 10
  * x            (x) float64 6kB 4.305e+05 4.307e+05 ... 5.415e+05 5.417e+05
  * y            (y) float64 6kB 2.715e+05 2.713e+05 ... 1.605e+05 1.604e+05
    spatial_ref  int64 8B 0
Attributes:
    AREA_OR_POINT:  Area
    _FillValue:     0
    scale_factor:   1.0
    add_offset:     0.0</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.DataArray</div><div class="xr-array-name"></div><ul class="xr-dim-list"><li><span class="xr-has-index">band</span>: 10</li><li><span class="xr-has-index">y</span>: 695</li><li><span class="xr-has-index">x</span>: 695</li></ul></div><ul class="xr-sections"><li class="xr-section-item"><div class="xr-array-wrap"><input id="section-09046b49-c26a-4e41-9ad8-22ef3aa49302" class="xr-array-in" type="checkbox" checked=""><label for="section-09046b49-c26a-4e41-9ad8-22ef3aa49302" title="Show/hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-array-preview xr-preview"><span>...</span></div><div class="xr-array-data"><pre>[4830250 values with dtype=uint16]</pre></div></div></li><li class="xr-section-item"><input id="section-a665a618-2575-4254-917f-a302a7555036" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-a665a618-2575-4254-917f-a302a7555036" class="xr-section-summary">Coordinates: <span>(4)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">band</span></div><div class="xr-var-dims">(band)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">1 2 3 4 5 6 7 8 9 10</div><input id="attrs-3bb87241-2163-4605-81b2-9e50a39f2dda" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-3bb87241-2163-4605-81b2-9e50a39f2dda" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-2236db8a-160c-43fa-a0b2-91e157c61fb7" class="xr-var-data-in" type="checkbox"><label for="data-2236db8a-160c-43fa-a0b2-91e157c61fb7" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">x</span></div><div class="xr-var-dims">(x)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">4.305e+05 4.307e+05 ... 5.417e+05</div><input id="attrs-64fd6973-67d0-4bc0-ade9-018001504e7d" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-64fd6973-67d0-4bc0-ade9-018001504e7d" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-2329c778-e581-4d2c-ace6-de451b49705d" class="xr-var-data-in" type="checkbox"><label for="data-2329c778-e581-4d2c-ace6-de451b49705d" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([430540.064748, 430700.194245, 430860.323741, ..., 541349.676259,
       541509.805755, 541669.935252])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">y</span></div><div class="xr-var-dims">(y)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">2.715e+05 2.713e+05 ... 1.604e+05</div><input id="attrs-a0e3dbd0-04b0-4d1c-93cd-0d68a7d6edab" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-a0e3dbd0-04b0-4d1c-93cd-0d68a7d6edab" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-bd6f5374-4bf9-47c2-8e39-e1754471f2bd" class="xr-var-data-in" type="checkbox"><label for="data-bd6f5374-4bf9-47c2-8e39-e1754471f2bd" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([271499.942446, 271339.827338, 271179.71223 , ..., 160700.28777 ,
       160540.172662, 160380.057554])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>spatial_ref</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0</div><input id="attrs-aa4ded4e-401a-4bbe-a296-a0a8584e911c" class="xr-var-attrs-in" type="checkbox"><label for="attrs-aa4ded4e-401a-4bbe-a296-a0a8584e911c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-644d0212-db89-465b-bc40-f13cac86191e" class="xr-var-data-in" type="checkbox"><label for="data-644d0212-db89-465b-bc40-f13cac86191e" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>crs_wkt :</span></dt><dd>PROJCS["OSGB36 / British National Grid",GEOGCS["OSGB36",DATUM["Ordnance_Survey_of_Great_Britain_1936",SPHEROID["Airy 1830",6377563.396,299.3249646,AUTHORITY["EPSG","7001"]],AUTHORITY["EPSG","6277"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4277"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",49],PARAMETER["central_meridian",-2],PARAMETER["scale_factor",0.9996012717],PARAMETER["false_easting",400000],PARAMETER["false_northing",-100000],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH],AUTHORITY["EPSG","27700"]]</dd><dt><span>semi_major_axis :</span></dt><dd>6377563.396</dd><dt><span>semi_minor_axis :</span></dt><dd>6356256.909237285</dd><dt><span>inverse_flattening :</span></dt><dd>299.3249646</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>Airy 1830</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>OSGB36</dd><dt><span>horizontal_datum_name :</span></dt><dd>Ordnance Survey of Great Britain 1936</dd><dt><span>projected_crs_name :</span></dt><dd>OSGB36 / British National Grid</dd><dt><span>grid_mapping_name :</span></dt><dd>transverse_mercator</dd><dt><span>latitude_of_projection_origin :</span></dt><dd>49.0</dd><dt><span>longitude_of_central_meridian :</span></dt><dd>-2.0</dd><dt><span>false_easting :</span></dt><dd>400000.0</dd><dt><span>false_northing :</span></dt><dd>-100000.0</dd><dt><span>scale_factor_at_central_meridian :</span></dt><dd>0.9996012717</dd><dt><span>spatial_ref :</span></dt><dd>PROJCS["OSGB36 / British National Grid",GEOGCS["OSGB36",DATUM["Ordnance_Survey_of_Great_Britain_1936",SPHEROID["Airy 1830",6377563.396,299.3249646,AUTHORITY["EPSG","7001"]],AUTHORITY["EPSG","6277"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4277"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",49],PARAMETER["central_meridian",-2],PARAMETER["scale_factor",0.9996012717],PARAMETER["false_easting",400000],PARAMETER["false_northing",-100000],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH],AUTHORITY["EPSG","27700"]]</dd><dt><span>GeoTransform :</span></dt><dd>430460.0 160.1294964028777 0.0 271580.0 0.0 -160.11510791366905</dd></dl></div><div class="xr-var-data"><pre>array(0)</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-20ba5f5b-fe04-4079-8648-70bff8e081f6" class="xr-section-summary-in" type="checkbox"><label for="section-20ba5f5b-fe04-4079-8648-70bff8e081f6" class="xr-section-summary">Indexes: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>band</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-9413b49f-125c-4cab-827d-0001102ad4ae" class="xr-index-data-in" type="checkbox"><label for="index-9413b49f-125c-4cab-827d-0001102ad4ae" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10], dtype='int64', name='band'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>x</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-8971f972-c5e7-425e-96c9-47b8f5031be9" class="xr-index-data-in" type="checkbox"><label for="index-8971f972-c5e7-425e-96c9-47b8f5031be9" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([430540.06474820146,  430700.1942446043,  430860.3237410072,
        431020.4532374101,   431180.582733813, 431340.71223021584,
        431500.8417266187,  431660.9712230216,  431821.1007194245,
       431981.23021582735,
       ...
        540228.7697841726,  540388.8992805756,  540549.0287769784,
        540709.1582733813,  540869.2877697842,   541029.417266187,
          541189.54676259,  541349.6762589929,  541509.8057553957,
        541669.9352517986],
      dtype='float64', name='x', length=695))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>y</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-b1f6b6cc-484b-47ab-8e37-dba4e60afa95" class="xr-index-data-in" type="checkbox"><label for="index-b1f6b6cc-484b-47ab-8e37-dba4e60afa95" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([ 271499.9424460432,  271339.8273381295, 271179.71223021584,
       271019.59712230216,  270859.4820143885, 270699.36690647487,
        270539.2517985612,  270379.1366906475, 270219.02158273384,
       270058.90647482016,
       ...
        161821.0935251799, 161660.97841726622, 161500.86330935254,
       161340.74820143887, 161180.63309352522, 161020.51798561154,
        160860.4028776979, 160700.28776978422, 160540.17266187054,
       160380.05755395687],
      dtype='float64', name='y', length=695))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-e49f8273-99cb-481e-ac58-03e9df0ecf48" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-e49f8273-99cb-481e-ac58-03e9df0ecf48" class="xr-section-summary">Attributes: <span>(4)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>AREA_OR_POINT :</span></dt><dd>Area</dd><dt><span>_FillValue :</span></dt><dd>0</dd><dt><span>scale_factor :</span></dt><dd>1.0</dd><dt><span>add_offset :</span></dt><dd>0.0</dd></dl></div></li></ul></div></div>
</div>
</div>
<div id="3a053560" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Band=7 in this corresponds to the nir band</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>rds.sel(band<span class="op">=</span><span class="dv">7</span>).plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="cubes_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="0cf1f321" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clip an area around the Harwell campus and show red band  </span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>aoi_geom <span class="op">=</span> [</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'type'</span>: <span class="st">'Polygon'</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'coordinates'</span>: [[</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>            [<span class="fl">446924.3516</span>, <span class="fl">187299.2148</span>],</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>            [<span class="fl">448642.7644</span>, <span class="fl">187286.4543</span>],</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>            [<span class="fl">48591.7224</span>, <span class="fl">185606.3229</span>],</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>            [<span class="fl">446886.0701</span>, <span class="fl">185602.0694</span>],</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>            [<span class="fl">446924.3516</span>, <span class="fl">187299.2148</span>],</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>        ]]</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>clipped <span class="op">=</span> rds.rio.clip(aoi_geom)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>clipped.sel(band<span class="op">=</span><span class="dv">2</span>).plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="cubes_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>This shows we can access the CEDA data as an xarray but it doesn’t help us create a data cube as my understanding is that all COG layers need to be loaded before the filtering can be done.</p>
<p>Is this correct? Is there a way to just dump all the COG assests into xarray and then filter after that to tidy it up?</p>
<hr>
</section>
<section id="odc-stac-and-element-84" class="level1">
<h1>ODC-STAC and Element-84</h1>
<p>I thought that it would be useful to try another tool (odc-stac) to see if this was more useful. I followed the online tutorial.</p>
<p>See: https://odc-stac.readthedocs.io/en/latest/notebooks/stac-load-e84-aws.html</p>
<div id="71259548-b7fc-4eef-b19d-58ac8f1c3f0d" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_bounds(bbox, invert_y<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Helper method for changing bounding box representation to leaflet notation</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co">    ``(lon1, lat1, lon2, lat2) -&gt; ((lat1, lon1), (lat2, lon2))``</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    x1, y1, x2, y2 <span class="op">=</span> bbox</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> invert_y:</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>        y1, y2 <span class="op">=</span> y2, y1</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ((y1, x1), (y2, x2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c693b8fb-13c2-4988-bee7-42c6f30ff8fa" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SET UP DASK CLIENT</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> dask.distributed.Client()</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>configure_rio(cloud_defaults<span class="op">=</span><span class="va">True</span>, aws<span class="op">=</span>{<span class="st">"aws_unsigned"</span>: <span class="va">True</span>}, client<span class="op">=</span>client) <span class="co"># sets up gdal for cloud use</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="66f2709b-8a98-455b-acea-7c80809ebbb1" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FIND STAC ITEMS</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up a bounding box to limit te search</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>km2deg <span class="op">=</span> <span class="fl">1.0</span> <span class="op">/</span> <span class="dv">111</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> (lon, lat)  <span class="co"># Center point of a query</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="dv">25</span> <span class="op">*</span> km2deg</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>bbox <span class="op">=</span> (x <span class="op">-</span> r, y <span class="op">-</span> r, x <span class="op">+</span> r, y <span class="op">+</span> r)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>catalog <span class="op">=</span> Client.<span class="bu">open</span>(EURL)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> catalog.search(</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    collections<span class="op">=</span>[<span class="st">"sentinel-2-l2a"</span>], datetime<span class="op">=</span><span class="st">"2023-06-15"</span>, limit<span class="op">=</span><span class="dv">100</span>, bbox<span class="op">=</span>bbox</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>items <span class="op">=</span> <span class="bu">list</span>(query.items())</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Found: </span><span class="sc">{</span><span class="bu">len</span>(items)<span class="sc">:d}</span><span class="ss"> datasets"</span>)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert STAC items into a GeoJSON FeatureCollection</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>stac_json <span class="op">=</span> query.item_collection_as_dict()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Found: 4 datasets</code></pre>
</div>
</div>
<div id="1bfcf9eb-b6d8-485a-ba7c-916450001a7c" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># REVIEW SEARCH RESULTS</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>gdf <span class="op">=</span> gpd.GeoDataFrame.from_features(stac_json, <span class="st">"epsg:4326"</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute granule id from components</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>gdf[<span class="st">"granule"</span>] <span class="op">=</span> (</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    gdf[<span class="st">"mgrs:utm_zone"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f"</span><span class="sc">{</span>x<span class="sc">:02d}</span><span class="ss">"</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> gdf[<span class="st">"mgrs:latitude_band"</span>]</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> gdf[<span class="st">"mgrs:grid_square"</span>]</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co"># https://github.com/python-visualization/folium/issues/1501</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> branca.element <span class="im">import</span> Figure</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> Figure(width<span class="op">=</span><span class="st">"400px"</span>, height<span class="op">=</span><span class="st">"500px"</span>)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>map1 <span class="op">=</span> folium.Map()</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>fig.add_child(map1)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>folium.GeoJson(</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    shapely.geometry.box(<span class="op">*</span>bbox),</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    style_function<span class="op">=</span><span class="kw">lambda</span> x: <span class="bu">dict</span>(fill<span class="op">=</span><span class="va">False</span>, weight<span class="op">=</span><span class="dv">1</span>, opacity<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span><span class="st">"olive"</span>),</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"Query"</span>,</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>).add_to(map1)</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>gdf.explore(</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"granule"</span>,</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    categorical<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    tooltip<span class="op">=</span>[</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">"granule"</span>,</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">"datetime"</span>,</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">"eo:cloud_cover"</span>,</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>    popup<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>    style_kwds<span class="op">=</span><span class="bu">dict</span>(fillOpacity<span class="op">=</span><span class="fl">0.1</span>, width<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"STAC"</span>,</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>    m<span class="op">=</span>map1,</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>map1.fit_bounds(bounds<span class="op">=</span>convert_bounds(gdf.unary_union.bounds))</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>display(fig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_54469/1895939222.py:39: DeprecationWarning: The 'unary_union' attribute is deprecated, use the 'union_all()' method instead.
  map1.fit_bounds(bounds=convert_bounds(gdf.unary_union.bounds))</code></pre>
</div>
<div class="cell-output cell-output-display">
<iframe srcdoc="<!DOCTYPE html>
<html>
<head>
    
    <meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; />
    
        <script>
            L_NO_TOUCH = false;
            L_DISABLE_3D = false;
        </script>
    
    <style>html, body {width: 100%;height: 100%;margin: 0;padding: 0;}</style>
    <style>#map {position:absolute;top:0;bottom:0;right:0;left:0;}</style>
    <script src=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js&quot;></script>
    <script src=&quot;https://code.jquery.com/jquery-3.7.1.min.js&quot;></script>
    <script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js&quot;></script>
    <script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js&quot;></script>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css&quot;/>
    
            <meta name=&quot;viewport&quot; content=&quot;width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot; />
            <style>
                #map_0183a991e3d054fa7b16c5dacef9d024 {
                    position: relative;
                    width: 100.0%;
                    height: 100.0%;
                    left: 0.0%;
                    top: 0.0%;
                }
                .leaflet-container { font-size: 1rem; }
            </style>
        
    
                    <style>
                        .foliumtooltip {
                            
                        }
                       .foliumtooltip table{
                            margin: auto;
                        }
                        .foliumtooltip tr{
                            text-align: left;
                        }
                        .foliumtooltip th{
                            padding: 2px; padding-right: 8px;
                        }
                    </style>
            
    
                    <style>
                        .foliumpopup {
                            margin: auto;
                        }
                       .foliumpopup table{
                            margin: auto;
                        }
                        .foliumpopup tr{
                            text-align: left;
                        }
                        .foliumpopup th{
                            padding: 2px; padding-right: 8px;
                        }
                    </style>
            
    
    <script src=&quot;https://code.jquery.com/ui/1.12.1/jquery-ui.js&quot;></script>
    <script>$( function() {
        $( &quot;.maplegend&quot; ).draggable({
            start: function (event, ui) {
                $(this).css({
                    right: &quot;auto&quot;,
                    top: &quot;auto&quot;,
                    bottom: &quot;auto&quot;
                });
            }
        });
    });
    </script>
    <style type='text/css'>
      .maplegend {
        position: absolute;
        z-index:9999;
        background-color: rgba(255, 255, 255, .8);
        border-radius: 5px;
        box-shadow: 0 0 15px rgba(0,0,0,0.2);
        padding: 10px;
        font: 12px/14px Arial, Helvetica, sans-serif;
        right: 10px;
        bottom: 20px;
      }
      .maplegend .legend-title {
        text-align: left;
        margin-bottom: 5px;
        font-weight: bold;
        }
      .maplegend .legend-scale ul {
        margin: 0;
        margin-bottom: 0px;
        padding: 0;
        float: left;
        list-style: none;
        }
      .maplegend .legend-scale ul li {
        list-style: none;
        margin-left: 0;
        line-height: 16px;
        margin-bottom: 2px;
        }
      .maplegend ul.legend-labels li span {
        display: block;
        float: left;
        height: 14px;
        width: 14px;
        margin-right: 5px;
        margin-left: 0;
        border: 0px solid #ccc;
        }
      .maplegend .legend-source {
        color: #777;
        clear: both;
        }
      .maplegend a {
        color: #777;
        }
    </style>
    
</head>
<body>
    
    
    <div id='maplegend granule' class='maplegend'>
        <div class='legend-title'>granule</div>
        <div class='legend-scale'>
            <ul class='legend-labels'>
                <li><span style='background:#1f77b4'></span>30UWB</li>
                <li><span style='background:#d62728'></span>30UWC</li>
                <li><span style='background:#f7b6d2'></span>30UXB</li>
                <li><span style='background:#9edae5'></span>30UXC</li>
            </ul>
        </div>
    </div>
    
    
            <div class=&quot;folium-map&quot; id=&quot;map_0183a991e3d054fa7b16c5dacef9d024&quot; ></div>
        
</body>
<script>
    
    
            var map_0183a991e3d054fa7b16c5dacef9d024 = L.map(
                &quot;map_0183a991e3d054fa7b16c5dacef9d024&quot;,
                {
                    center: [0.0, 0.0],
                    crs: L.CRS.EPSG3857,
                    zoom: 1,
                    zoomControl: true,
                    preferCanvas: false,
                }
            );

            

        
    
            var tile_layer_8bc0db312da24eb68587121cbe7f57c4 = L.tileLayer(
                &quot;https://tile.openstreetmap.org/{z}/{x}/{y}.png&quot;,
                {&quot;attribution&quot;: &quot;\u0026copy; \u003ca href=\&quot;https://www.openstreetmap.org/copyright\&quot;\u003eOpenStreetMap\u003c/a\u003e contributors&quot;, &quot;detectRetina&quot;: false, &quot;maxNativeZoom&quot;: 19, &quot;maxZoom&quot;: 19, &quot;minZoom&quot;: 0, &quot;noWrap&quot;: false, &quot;opacity&quot;: 1, &quot;subdomains&quot;: &quot;abc&quot;, &quot;tms&quot;: false}
            );
        
    
            tile_layer_8bc0db312da24eb68587121cbe7f57c4.addTo(map_0183a991e3d054fa7b16c5dacef9d024);
        
    
        function geo_json_7e71675b0126947ce05b87348c179ffc_styler(feature) {
            switch(feature.id) {
                default:
                    return {&quot;color&quot;: &quot;olive&quot;, &quot;fill&quot;: false, &quot;opacity&quot;: 0.7, &quot;weight&quot;: 1};
            }
        }

        function geo_json_7e71675b0126947ce05b87348c179ffc_onEachFeature(feature, layer) {
            layer.on({
            });
        };
        var geo_json_7e71675b0126947ce05b87348c179ffc = L.geoJson(null, {
                onEachFeature: geo_json_7e71675b0126947ce05b87348c179ffc_onEachFeature,
            
                style: geo_json_7e71675b0126947ce05b87348c179ffc_styler,
        });

        function geo_json_7e71675b0126947ce05b87348c179ffc_add (data) {
            geo_json_7e71675b0126947ce05b87348c179ffc
                .addData(data);
        }
            geo_json_7e71675b0126947ce05b87348c179ffc_add({&quot;features&quot;: [{&quot;geometry&quot;: {&quot;coordinates&quot;: [[[-1.0891747747747749, 51.350274774774775], [-1.0891747747747749, 51.80072522522522], [-1.5396252252252252, 51.80072522522522], [-1.5396252252252252, 51.350274774774775], [-1.0891747747747749, 51.350274774774775]]], &quot;type&quot;: &quot;Polygon&quot;}, &quot;id&quot;: &quot;0&quot;, &quot;type&quot;: &quot;Feature&quot;}], &quot;type&quot;: &quot;FeatureCollection&quot;});

        
    
            geo_json_7e71675b0126947ce05b87348c179ffc.addTo(map_0183a991e3d054fa7b16c5dacef9d024);
        
    
        function geo_json_63da39d95736790d1e4e7ef7222f0cdb_styler(feature) {
            switch(feature.id) {
                case &quot;0&quot;: 
                    return {&quot;color&quot;: &quot;#1f77b4&quot;, &quot;fillColor&quot;: &quot;#1f77b4&quot;, &quot;fillOpacity&quot;: 0.1, &quot;weight&quot;: 2, &quot;width&quot;: 2};
                case &quot;1&quot;: 
                    return {&quot;color&quot;: &quot;#f7b6d2&quot;, &quot;fillColor&quot;: &quot;#f7b6d2&quot;, &quot;fillOpacity&quot;: 0.1, &quot;weight&quot;: 2, &quot;width&quot;: 2};
                case &quot;2&quot;: 
                    return {&quot;color&quot;: &quot;#d62728&quot;, &quot;fillColor&quot;: &quot;#d62728&quot;, &quot;fillOpacity&quot;: 0.1, &quot;weight&quot;: 2, &quot;width&quot;: 2};
                default:
                    return {&quot;color&quot;: &quot;#9edae5&quot;, &quot;fillColor&quot;: &quot;#9edae5&quot;, &quot;fillOpacity&quot;: 0.1, &quot;weight&quot;: 2, &quot;width&quot;: 2};
            }
        }
        function geo_json_63da39d95736790d1e4e7ef7222f0cdb_highlighter(feature) {
            switch(feature.id) {
                default:
                    return {&quot;fillOpacity&quot;: 0.75};
            }
        }
        function geo_json_63da39d95736790d1e4e7ef7222f0cdb_pointToLayer(feature, latlng) {
            var opts = {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;#3388ff&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;#3388ff&quot;, &quot;fillOpacity&quot;: 0.2, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 2, &quot;stroke&quot;: true, &quot;weight&quot;: 3};
            
            let style = geo_json_63da39d95736790d1e4e7ef7222f0cdb_styler(feature)
            Object.assign(opts, style)
            
            return new L.CircleMarker(latlng, opts)
        }

        function geo_json_63da39d95736790d1e4e7ef7222f0cdb_onEachFeature(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    if(typeof e.target.setStyle === &quot;function&quot;){
                            geo_json_63da39d95736790d1e4e7ef7222f0cdb.resetStyle(e.target);
                    }
                },
                mouseover: function(e) {
                    if(typeof e.target.setStyle === &quot;function&quot;){
                        const highlightStyle = geo_json_63da39d95736790d1e4e7ef7222f0cdb_highlighter(e.target.feature)
                        e.target.setStyle(highlightStyle);
                    }
                },
            });
        };
        var geo_json_63da39d95736790d1e4e7ef7222f0cdb = L.geoJson(null, {
                onEachFeature: geo_json_63da39d95736790d1e4e7ef7222f0cdb_onEachFeature,
            
                style: geo_json_63da39d95736790d1e4e7ef7222f0cdb_styler,
                pointToLayer: geo_json_63da39d95736790d1e4e7ef7222f0cdb_pointToLayer,
        });

        function geo_json_63da39d95736790d1e4e7ef7222f0cdb_add (data) {
            geo_json_63da39d95736790d1e4e7ef7222f0cdb
                .addData(data);
        }
            geo_json_63da39d95736790d1e4e7ef7222f0cdb_add({&quot;bbox&quot;: [-3.0002745311477614, 50.426302998796906, 0.07774265507730611, 52.35008187595863], &quot;features&quot;: [{&quot;bbox&quot;: [-3.0002734328875422, 50.45353245566084, -1.420470671052018, 51.45117321354576], &quot;geometry&quot;: {&quot;coordinates&quot;: [[[-3.0002734328875422, 51.45117321354576], [-1.420470671052018, 51.44053237075877], [-1.4535773466400304, 50.45353245566084], [-3.000267698965042, 50.46380739464256], [-3.0002734328875422, 51.45117321354576]]], &quot;type&quot;: &quot;Polygon&quot;}, &quot;id&quot;: &quot;0&quot;, &quot;properties&quot;: {&quot;__folium_color&quot;: &quot;#1f77b4&quot;, &quot;constellation&quot;: &quot;sentinel-2&quot;, &quot;created&quot;: &quot;2023-06-15T19:16:55.050Z&quot;, &quot;datetime&quot;: &quot;2023-06-15T11:17:11.659000Z&quot;, &quot;earthsearch:boa_offset_applied&quot;: true, &quot;earthsearch:payload_id&quot;: &quot;roda-sentinel2/workflow-sentinel2-to-stac/d1d608f54fd0eaa52d84b4c76ff95807&quot;, &quot;earthsearch:s3_path&quot;: &quot;s3://sentinel-cogs/sentinel-s2-l2a-cogs/30/U/WB/2023/6/S2B_30UWB_20230615_0_L2A&quot;, &quot;eo:cloud_cover&quot;: 6.424985, &quot;granule&quot;: &quot;30UWB&quot;, &quot;grid:code&quot;: &quot;MGRS-30UWB&quot;, &quot;instruments&quot;: &quot;[\u0027msi\u0027]&quot;, &quot;mgrs:grid_square&quot;: &quot;WB&quot;, &quot;mgrs:latitude_band&quot;: &quot;U&quot;, &quot;mgrs:utm_zone&quot;: 30, &quot;platform&quot;: &quot;sentinel-2b&quot;, &quot;processing:software&quot;: &quot;{\u0027sentinel2-to-stac\u0027: \u00270.1.0\u0027}&quot;, &quot;proj:epsg&quot;: 32630, &quot;s2:cloud_shadow_percentage&quot;: 1.294415, &quot;s2:dark_features_percentage&quot;: 0.005007, &quot;s2:datastrip_id&quot;: &quot;S2B_OPER_MSI_L2A_DS_2BPS_20230615T135807_S20230615T110637_N05.09&quot;, &quot;s2:datatake_id&quot;: &quot;GS2B_20230615T110629_032767_N05.09&quot;, &quot;s2:datatake_type&quot;: &quot;INS-NOBS&quot;, &quot;s2:degraded_msi_data_percentage&quot;: 0.0218, &quot;s2:generation_time&quot;: &quot;2023-06-15T13:58:07.000000Z&quot;, &quot;s2:granule_id&quot;: &quot;S2B_OPER_MSI_L2A_TL_2BPS_20230615T135807_A032767_T30UWB_N05.09&quot;, &quot;s2:high_proba_clouds_percentage&quot;: 0.468134, &quot;s2:medium_proba_clouds_percentage&quot;: 1.483074, &quot;s2:nodata_pixel_percentage&quot;: 0.0, &quot;s2:not_vegetated_percentage&quot;: 6.522211, &quot;s2:processing_baseline&quot;: &quot;05.09&quot;, &quot;s2:product_type&quot;: &quot;S2MSI2A&quot;, &quot;s2:product_uri&quot;: &quot;S2B_MSIL2A_20230615T110629_N0509_R137_T30UWB_20230615T135807.SAFE&quot;, &quot;s2:reflectance_conversion_factor&quot;: 0.969974212286044, &quot;s2:saturated_defective_pixel_percentage&quot;: 0, &quot;s2:sequence&quot;: &quot;0&quot;, &quot;s2:snow_ice_percentage&quot;: 1.3e-05, &quot;s2:thin_cirrus_percentage&quot;: 4.473777, &quot;s2:unclassified_percentage&quot;: 0.093616, &quot;s2:vegetation_percentage&quot;: 67.472243, &quot;s2:water_percentage&quot;: 18.187508, &quot;updated&quot;: &quot;2023-06-15T19:16:55.050Z&quot;, &quot;view:sun_azimuth&quot;: 155.074742496581, &quot;view:sun_elevation&quot;: 60.5645911266741}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-1.5912705406928833, 50.426302998796906, 0.017010057895362144, 51.44234315083263], &quot;geometry&quot;: {&quot;coordinates&quot;: [[[-1.56110910424689, 51.44234315083263], [0.017010057895362144, 51.412334045131], [-0.046143787227810526, 50.426302998796906], [-1.5912705406928833, 50.455280980314996], [-1.56110910424689, 51.44234315083263]]], &quot;type&quot;: &quot;Polygon&quot;}, &quot;id&quot;: &quot;1&quot;, &quot;properties&quot;: {&quot;__folium_color&quot;: &quot;#f7b6d2&quot;, &quot;constellation&quot;: &quot;sentinel-2&quot;, &quot;created&quot;: &quot;2023-06-15T19:15:45.878Z&quot;, &quot;datetime&quot;: &quot;2023-06-15T11:17:08.043000Z&quot;, &quot;earthsearch:boa_offset_applied&quot;: true, &quot;earthsearch:payload_id&quot;: &quot;roda-sentinel2/workflow-sentinel2-to-stac/89ba9a5e2149075a90e32c169a35a5f0&quot;, &quot;earthsearch:s3_path&quot;: &quot;s3://sentinel-cogs/sentinel-s2-l2a-cogs/30/U/XB/2023/6/S2B_30UXB_20230615_0_L2A&quot;, &quot;eo:cloud_cover&quot;: 36.624199, &quot;granule&quot;: &quot;30UXB&quot;, &quot;grid:code&quot;: &quot;MGRS-30UXB&quot;, &quot;instruments&quot;: &quot;[\u0027msi\u0027]&quot;, &quot;mgrs:grid_square&quot;: &quot;XB&quot;, &quot;mgrs:latitude_band&quot;: &quot;U&quot;, &quot;mgrs:utm_zone&quot;: 30, &quot;platform&quot;: &quot;sentinel-2b&quot;, &quot;processing:software&quot;: &quot;{\u0027sentinel2-to-stac\u0027: \u00270.1.0\u0027}&quot;, &quot;proj:epsg&quot;: 32630, &quot;s2:cloud_shadow_percentage&quot;: 0.847605, &quot;s2:dark_features_percentage&quot;: 0.004675, &quot;s2:datastrip_id&quot;: &quot;S2B_OPER_MSI_L2A_DS_2BPS_20230615T135807_S20230615T110637_N05.09&quot;, &quot;s2:datatake_id&quot;: &quot;GS2B_20230615T110629_032767_N05.09&quot;, &quot;s2:datatake_type&quot;: &quot;INS-NOBS&quot;, &quot;s2:degraded_msi_data_percentage&quot;: 0.0007, &quot;s2:generation_time&quot;: &quot;2023-06-15T13:58:07.000000Z&quot;, &quot;s2:granule_id&quot;: &quot;S2B_OPER_MSI_L2A_TL_2BPS_20230615T135807_A032767_T30UXB_N05.09&quot;, &quot;s2:high_proba_clouds_percentage&quot;: 0.537868, &quot;s2:medium_proba_clouds_percentage&quot;: 2.661862, &quot;s2:nodata_pixel_percentage&quot;: 0.0, &quot;s2:not_vegetated_percentage&quot;: 4.861756, &quot;s2:processing_baseline&quot;: &quot;05.09&quot;, &quot;s2:product_type&quot;: &quot;S2MSI2A&quot;, &quot;s2:product_uri&quot;: &quot;S2B_MSIL2A_20230615T110629_N0509_R137_T30UXB_20230615T135807.SAFE&quot;, &quot;s2:reflectance_conversion_factor&quot;: 0.969974212286044, &quot;s2:saturated_defective_pixel_percentage&quot;: 0, &quot;s2:sequence&quot;: &quot;0&quot;, &quot;s2:snow_ice_percentage&quot;: 0.000186, &quot;s2:thin_cirrus_percentage&quot;: 33.424467, &quot;s2:unclassified_percentage&quot;: 0.083245, &quot;s2:vegetation_percentage&quot;: 35.237375, &quot;s2:water_percentage&quot;: 22.340961, &quot;updated&quot;: &quot;2023-06-15T19:15:45.878Z&quot;, &quot;view:sun_azimuth&quot;: 157.610200039352, &quot;view:sun_elevation&quot;: 60.9378194682426}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-3.0002745311477614, 51.3526430745357, -1.3886306359678395, 52.35008187595863], &quot;geometry&quot;: {&quot;coordinates&quot;: [[[-2.699413740305603, 52.35008187595863], [-1.3886306359678395, 52.339476064927915], [-1.423495382112171, 51.3526430745357], [-3.0002729090141034, 51.3632506993238], [-3.0002745311477614, 51.634058243352555], [-2.699413740305603, 52.35008187595863]]], &quot;type&quot;: &quot;Polygon&quot;}, &quot;id&quot;: &quot;2&quot;, &quot;properties&quot;: {&quot;__folium_color&quot;: &quot;#d62728&quot;, &quot;constellation&quot;: &quot;sentinel-2&quot;, &quot;created&quot;: &quot;2023-06-15T19:19:01.490Z&quot;, &quot;datetime&quot;: &quot;2023-06-15T11:16:57.326000Z&quot;, &quot;earthsearch:boa_offset_applied&quot;: true, &quot;earthsearch:payload_id&quot;: &quot;roda-sentinel2/workflow-sentinel2-to-stac/fd3b65384144c965a3df4c544622d410&quot;, &quot;earthsearch:s3_path&quot;: &quot;s3://sentinel-cogs/sentinel-s2-l2a-cogs/30/U/WC/2023/6/S2B_30UWC_20230615_0_L2A&quot;, &quot;eo:cloud_cover&quot;: 40.942103, &quot;granule&quot;: &quot;30UWC&quot;, &quot;grid:code&quot;: &quot;MGRS-30UWC&quot;, &quot;instruments&quot;: &quot;[\u0027msi\u0027]&quot;, &quot;mgrs:grid_square&quot;: &quot;WC&quot;, &quot;mgrs:latitude_band&quot;: &quot;U&quot;, &quot;mgrs:utm_zone&quot;: 30, &quot;platform&quot;: &quot;sentinel-2b&quot;, &quot;processing:software&quot;: &quot;{\u0027sentinel2-to-stac\u0027: \u00270.1.0\u0027}&quot;, &quot;proj:epsg&quot;: 32630, &quot;s2:cloud_shadow_percentage&quot;: 0.452932, &quot;s2:dark_features_percentage&quot;: 0.009144, &quot;s2:datastrip_id&quot;: &quot;S2B_OPER_MSI_L2A_DS_2BPS_20230615T135807_S20230615T110637_N05.09&quot;, &quot;s2:datatake_id&quot;: &quot;GS2B_20230615T110629_032767_N05.09&quot;, &quot;s2:datatake_type&quot;: &quot;INS-NOBS&quot;, &quot;s2:degraded_msi_data_percentage&quot;: 0.0191, &quot;s2:generation_time&quot;: &quot;2023-06-15T13:58:07.000000Z&quot;, &quot;s2:granule_id&quot;: &quot;S2B_OPER_MSI_L2A_TL_2BPS_20230615T135807_A032767_T30UWC_N05.09&quot;, &quot;s2:high_proba_clouds_percentage&quot;: 0.47498, &quot;s2:medium_proba_clouds_percentage&quot;: 5.23848, &quot;s2:nodata_pixel_percentage&quot;: 6.713043, &quot;s2:not_vegetated_percentage&quot;: 5.836358, &quot;s2:processing_baseline&quot;: &quot;05.09&quot;, &quot;s2:product_type&quot;: &quot;S2MSI2A&quot;, &quot;s2:product_uri&quot;: &quot;S2B_MSIL2A_20230615T110629_N0509_R137_T30UWC_20230615T135807.SAFE&quot;, &quot;s2:reflectance_conversion_factor&quot;: 0.969974212286044, &quot;s2:saturated_defective_pixel_percentage&quot;: 0, &quot;s2:sequence&quot;: &quot;0&quot;, &quot;s2:snow_ice_percentage&quot;: 0.0, &quot;s2:thin_cirrus_percentage&quot;: 35.228643, &quot;s2:unclassified_percentage&quot;: 0.115237, &quot;s2:vegetation_percentage&quot;: 50.371784, &quot;s2:water_percentage&quot;: 2.27244, &quot;updated&quot;: &quot;2023-06-15T19:19:01.490Z&quot;, &quot;view:sun_azimuth&quot;: 155.647735764461, &quot;view:sun_elevation&quot;: 59.7353624500238}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-1.56386473741635, 51.324532702654174, 0.07774265507730611, 52.341345926982605], &quot;geometry&quot;: {&quot;coordinates&quot;: [[[-1.5321014711153584, 52.341345926982605], [0.07774265507730611, 52.31035831899578], [0.011240379466618532, 51.324532702654174], [-1.56386473741635, 51.35444820290043], [-1.5321014711153584, 52.341345926982605]]], &quot;type&quot;: &quot;Polygon&quot;}, &quot;id&quot;: &quot;3&quot;, &quot;properties&quot;: {&quot;__folium_color&quot;: &quot;#9edae5&quot;, &quot;constellation&quot;: &quot;sentinel-2&quot;, &quot;created&quot;: &quot;2023-06-15T19:17:44.639Z&quot;, &quot;datetime&quot;: &quot;2023-06-15T11:16:53.575000Z&quot;, &quot;earthsearch:boa_offset_applied&quot;: true, &quot;earthsearch:payload_id&quot;: &quot;roda-sentinel2/workflow-sentinel2-to-stac/79e7c5a2b3247cc01f8e9fef92f995ca&quot;, &quot;earthsearch:s3_path&quot;: &quot;s3://sentinel-cogs/sentinel-s2-l2a-cogs/30/U/XC/2023/6/S2B_30UXC_20230615_0_L2A&quot;, &quot;eo:cloud_cover&quot;: 47.293755, &quot;granule&quot;: &quot;30UXC&quot;, &quot;grid:code&quot;: &quot;MGRS-30UXC&quot;, &quot;instruments&quot;: &quot;[\u0027msi\u0027]&quot;, &quot;mgrs:grid_square&quot;: &quot;XC&quot;, &quot;mgrs:latitude_band&quot;: &quot;U&quot;, &quot;mgrs:utm_zone&quot;: 30, &quot;platform&quot;: &quot;sentinel-2b&quot;, &quot;processing:software&quot;: &quot;{\u0027sentinel2-to-stac\u0027: \u00270.1.0\u0027}&quot;, &quot;proj:epsg&quot;: 32630, &quot;s2:cloud_shadow_percentage&quot;: 1.971009, &quot;s2:dark_features_percentage&quot;: 0.001908, &quot;s2:datastrip_id&quot;: &quot;S2B_OPER_MSI_L2A_DS_2BPS_20230615T135807_S20230615T110637_N05.09&quot;, &quot;s2:datatake_id&quot;: &quot;GS2B_20230615T110629_032767_N05.09&quot;, &quot;s2:datatake_type&quot;: &quot;INS-NOBS&quot;, &quot;s2:degraded_msi_data_percentage&quot;: 0.0091, &quot;s2:generation_time&quot;: &quot;2023-06-15T13:58:07.000000Z&quot;, &quot;s2:granule_id&quot;: &quot;S2B_OPER_MSI_L2A_TL_2BPS_20230615T135807_A032767_T30UXC_N05.09&quot;, &quot;s2:high_proba_clouds_percentage&quot;: 1.130527, &quot;s2:medium_proba_clouds_percentage&quot;: 8.529358, &quot;s2:nodata_pixel_percentage&quot;: 3e-06, &quot;s2:not_vegetated_percentage&quot;: 6.505898, &quot;s2:processing_baseline&quot;: &quot;05.09&quot;, &quot;s2:product_type&quot;: &quot;S2MSI2A&quot;, &quot;s2:product_uri&quot;: &quot;S2B_MSIL2A_20230615T110629_N0509_R137_T30UXC_20230615T135807.SAFE&quot;, &quot;s2:reflectance_conversion_factor&quot;: 0.969974212286044, &quot;s2:saturated_defective_pixel_percentage&quot;: 0, &quot;s2:sequence&quot;: &quot;0&quot;, &quot;s2:snow_ice_percentage&quot;: 3e-06, &quot;s2:thin_cirrus_percentage&quot;: 37.633869, &quot;s2:unclassified_percentage&quot;: 0.123072, &quot;s2:vegetation_percentage&quot;: 43.811196, &quot;s2:water_percentage&quot;: 0.293158, &quot;updated&quot;: &quot;2023-06-15T19:17:44.639Z&quot;, &quot;view:sun_azimuth&quot;: 158.177526828233, &quot;view:sun_elevation&quot;: 60.1011534359482}, &quot;type&quot;: &quot;Feature&quot;}], &quot;type&quot;: &quot;FeatureCollection&quot;});

        
    
    geo_json_63da39d95736790d1e4e7ef7222f0cdb.bindTooltip(
    function(layer){
    let div = L.DomUtil.create('div');
    
    let handleObject = feature=>typeof(feature)=='object' ? JSON.stringify(feature) : feature;
    let fields = [&quot;granule&quot;, &quot;datetime&quot;, &quot;eo:cloud_cover&quot;];
    let aliases = [&quot;granule&quot;, &quot;datetime&quot;, &quot;eo:cloud_cover&quot;];
    let table = '<table>' +
        String(
        fields.map(
        (v,i)=>
        `<tr>
            <th>${aliases[i]}</th>
            
            <td>${handleObject(layer.feature.properties[v])}</td>
        </tr>`).join(''))
    +'</table>';
    div.innerHTML=table;
    
    return div
    }
    ,{&quot;className&quot;: &quot;foliumtooltip&quot;, &quot;sticky&quot;: true});
                     
    
    geo_json_63da39d95736790d1e4e7ef7222f0cdb.bindPopup(
    function(layer){
    let div = L.DomUtil.create('div');
    
    let handleObject = feature=>typeof(feature)=='object' ? JSON.stringify(feature) : feature;
    let fields = [&quot;created&quot;, &quot;platform&quot;, &quot;constellation&quot;, &quot;instruments&quot;, &quot;eo:cloud_cover&quot;, &quot;proj:epsg&quot;, &quot;mgrs:utm_zone&quot;, &quot;mgrs:latitude_band&quot;, &quot;mgrs:grid_square&quot;, &quot;grid:code&quot;, &quot;view:sun_azimuth&quot;, &quot;view:sun_elevation&quot;, &quot;s2:degraded_msi_data_percentage&quot;, &quot;s2:nodata_pixel_percentage&quot;, &quot;s2:saturated_defective_pixel_percentage&quot;, &quot;s2:dark_features_percentage&quot;, &quot;s2:cloud_shadow_percentage&quot;, &quot;s2:vegetation_percentage&quot;, &quot;s2:not_vegetated_percentage&quot;, &quot;s2:water_percentage&quot;, &quot;s2:unclassified_percentage&quot;, &quot;s2:medium_proba_clouds_percentage&quot;, &quot;s2:high_proba_clouds_percentage&quot;, &quot;s2:thin_cirrus_percentage&quot;, &quot;s2:snow_ice_percentage&quot;, &quot;s2:product_type&quot;, &quot;s2:processing_baseline&quot;, &quot;s2:product_uri&quot;, &quot;s2:generation_time&quot;, &quot;s2:datatake_id&quot;, &quot;s2:datatake_type&quot;, &quot;s2:datastrip_id&quot;, &quot;s2:granule_id&quot;, &quot;s2:reflectance_conversion_factor&quot;, &quot;datetime&quot;, &quot;s2:sequence&quot;, &quot;earthsearch:s3_path&quot;, &quot;earthsearch:payload_id&quot;, &quot;earthsearch:boa_offset_applied&quot;, &quot;processing:software&quot;, &quot;updated&quot;, &quot;granule&quot;];
    let aliases = [&quot;created&quot;, &quot;platform&quot;, &quot;constellation&quot;, &quot;instruments&quot;, &quot;eo:cloud_cover&quot;, &quot;proj:epsg&quot;, &quot;mgrs:utm_zone&quot;, &quot;mgrs:latitude_band&quot;, &quot;mgrs:grid_square&quot;, &quot;grid:code&quot;, &quot;view:sun_azimuth&quot;, &quot;view:sun_elevation&quot;, &quot;s2:degraded_msi_data_percentage&quot;, &quot;s2:nodata_pixel_percentage&quot;, &quot;s2:saturated_defective_pixel_percentage&quot;, &quot;s2:dark_features_percentage&quot;, &quot;s2:cloud_shadow_percentage&quot;, &quot;s2:vegetation_percentage&quot;, &quot;s2:not_vegetated_percentage&quot;, &quot;s2:water_percentage&quot;, &quot;s2:unclassified_percentage&quot;, &quot;s2:medium_proba_clouds_percentage&quot;, &quot;s2:high_proba_clouds_percentage&quot;, &quot;s2:thin_cirrus_percentage&quot;, &quot;s2:snow_ice_percentage&quot;, &quot;s2:product_type&quot;, &quot;s2:processing_baseline&quot;, &quot;s2:product_uri&quot;, &quot;s2:generation_time&quot;, &quot;s2:datatake_id&quot;, &quot;s2:datatake_type&quot;, &quot;s2:datastrip_id&quot;, &quot;s2:granule_id&quot;, &quot;s2:reflectance_conversion_factor&quot;, &quot;datetime&quot;, &quot;s2:sequence&quot;, &quot;earthsearch:s3_path&quot;, &quot;earthsearch:payload_id&quot;, &quot;earthsearch:boa_offset_applied&quot;, &quot;processing:software&quot;, &quot;updated&quot;, &quot;granule&quot;];
    let table = '<table>' +
        String(
        fields.map(
        (v,i)=>
        `<tr>
            <th>${aliases[i].toLocaleString()}</th>
            
            <td>${handleObject(layer.feature.properties[v]).toLocaleString()}</td>
        </tr>`).join(''))
    +'</table>';
    div.innerHTML=table;
    
    return div
    }
    ,{&quot;className&quot;: &quot;foliumpopup&quot;});
                     
    
            geo_json_63da39d95736790d1e4e7ef7222f0cdb.addTo(map_0183a991e3d054fa7b16c5dacef9d024);
        
    
            map_0183a991e3d054fa7b16c5dacef9d024.fitBounds(
                [[50.426302998796906, -3.0002745311477614], [52.35008187595863, 0.07774265507730611]],
                {}
            );
        
</script>
</html>" width="400px" height="500px" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"=""></iframe>
</div>
</div>
<div id="48ca36f9-388f-42f5-ac6b-2a0052e26a97" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>items</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>[&lt;Item id=S2B_30UWB_20230615_0_L2A&gt;,
 &lt;Item id=S2B_30UXB_20230615_0_L2A&gt;,
 &lt;Item id=S2B_30UWC_20230615_0_L2A&gt;,
 &lt;Item id=S2B_30UXC_20230615_0_L2A&gt;]</code></pre>
</div>
</div>
<div id="4e3c673b-95cf-4a50-a85f-600e5da53d8c" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CONSTRUCT DASK DATASET</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Since we will plot it on a map we need to use `EPSG:3857` projection</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>crs <span class="op">=</span> <span class="st">"epsg:3857"</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>zoom <span class="op">=</span> <span class="dv">2</span><span class="op">**</span><span class="dv">5</span>  <span class="co"># overview level 5</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>xx <span class="op">=</span> stac_load(</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    items,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    bands<span class="op">=</span>(<span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>),</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    crs<span class="op">=</span>crs,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    resolution<span class="op">=</span><span class="dv">10</span> <span class="op">*</span> zoom,</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    chunks<span class="op">=</span>{},  <span class="co"># &lt;-- use Dask</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>display(xx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt; Size: 28MB
Dimensions:      (y: 1074, x: 1072, time: 4)
Coordinates:
  * y            (y) float64 9kB 6.864e+06 6.864e+06 ... 6.521e+06 6.52e+06
  * x            (x) float64 9kB -3.339e+05 -3.336e+05 ... 8.48e+03 8.8e+03
    spatial_ref  int32 4B 3857
  * time         (time) datetime64[ns] 32B 2023-06-15T11:16:53.575000 ... 202...
Data variables:
    red          (time, y, x) uint16 9MB dask.array&lt;chunksize=(1, 1074, 1072), meta=np.ndarray&gt;
    green        (time, y, x) uint16 9MB dask.array&lt;chunksize=(1, 1074, 1072), meta=np.ndarray&gt;
    blue         (time, y, x) uint16 9MB dask.array&lt;chunksize=(1, 1074, 1072), meta=np.ndarray&gt;</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-609707fc-e6ed-4980-abb6-3d4d8fd8e0f1" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-609707fc-e6ed-4980-abb6-3d4d8fd8e0f1" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">y</span>: 1074</li><li><span class="xr-has-index">x</span>: 1072</li><li><span class="xr-has-index">time</span>: 4</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-198f7871-a34a-410b-a6cd-0bb3538f5504" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-198f7871-a34a-410b-a6cd-0bb3538f5504" class="xr-section-summary">Coordinates: <span>(4)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">y</span></div><div class="xr-var-dims">(y)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">6.864e+06 6.864e+06 ... 6.52e+06</div><input id="attrs-54eaf7af-dd39-470c-8c77-48b6c853b536" class="xr-var-attrs-in" type="checkbox"><label for="attrs-54eaf7af-dd39-470c-8c77-48b6c853b536" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-3e517c9f-1389-482d-a4e4-c49a018b8aeb" class="xr-var-data-in" type="checkbox"><label for="data-3e517c9f-1389-482d-a4e4-c49a018b8aeb" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>units :</span></dt><dd>metre</dd><dt><span>resolution :</span></dt><dd>-320.0</dd><dt><span>crs :</span></dt><dd>EPSG:3857</dd></dl></div><div class="xr-var-data"><pre>array([6863840., 6863520., 6863200., ..., 6521120., 6520800., 6520480.])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">x</span></div><div class="xr-var-dims">(x)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-3.339e+05 -3.336e+05 ... 8.8e+03</div><input id="attrs-53daedac-54a0-43dd-a382-df16dc1ed63c" class="xr-var-attrs-in" type="checkbox"><label for="attrs-53daedac-54a0-43dd-a382-df16dc1ed63c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-bff30511-2cc0-49e2-a29a-e4aca1261949" class="xr-var-data-in" type="checkbox"><label for="data-bff30511-2cc0-49e2-a29a-e4aca1261949" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>units :</span></dt><dd>metre</dd><dt><span>resolution :</span></dt><dd>320.0</dd><dt><span>crs :</span></dt><dd>EPSG:3857</dd></dl></div><div class="xr-var-data"><pre>array([-333920., -333600., -333280., ...,    8160.,    8480.,    8800.])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>spatial_ref</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">int32</div><div class="xr-var-preview xr-preview">3857</div><input id="attrs-b1bbf812-dfea-43b3-97b9-e68739d1c222" class="xr-var-attrs-in" type="checkbox"><label for="attrs-b1bbf812-dfea-43b3-97b9-e68739d1c222" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-015db9b7-a241-462e-a0c8-4c50eefbce03" class="xr-var-data-in" type="checkbox"><label for="data-015db9b7-a241-462e-a0c8-4c50eefbce03" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>spatial_ref :</span></dt><dd>PROJCRS["WGS 84 / Pseudo-Mercator",BASEGEOGCRS["WGS 84",ENSEMBLE["World Geodetic System 1984 ensemble",MEMBER["World Geodetic System 1984 (Transit)"],MEMBER["World Geodetic System 1984 (G730)"],MEMBER["World Geodetic System 1984 (G873)"],MEMBER["World Geodetic System 1984 (G1150)"],MEMBER["World Geodetic System 1984 (G1674)"],MEMBER["World Geodetic System 1984 (G1762)"],MEMBER["World Geodetic System 1984 (G2139)"],ELLIPSOID["WGS 84",6378137,298.257223563,LENGTHUNIT["metre",1]],ENSEMBLEACCURACY[2.0]],PRIMEM["Greenwich",0,ANGLEUNIT["degree",0.0174532925199433]],ID["EPSG",4326]],CONVERSION["Popular Visualisation Pseudo-Mercator",METHOD["Popular Visualisation Pseudo Mercator",ID["EPSG",1024]],PARAMETER["Latitude of natural origin",0,ANGLEUNIT["degree",0.0174532925199433],ID["EPSG",8801]],PARAMETER["Longitude of natural origin",0,ANGLEUNIT["degree",0.0174532925199433],ID["EPSG",8802]],PARAMETER["False easting",0,LENGTHUNIT["metre",1],ID["EPSG",8806]],PARAMETER["False northing",0,LENGTHUNIT["metre",1],ID["EPSG",8807]]],CS[Cartesian,2],AXIS["easting (X)",east,ORDER[1],LENGTHUNIT["metre",1]],AXIS["northing (Y)",north,ORDER[2],LENGTHUNIT["metre",1]],USAGE[SCOPE["Web mapping and visualisation."],AREA["World between 85.06°S and 85.06°N."],BBOX[-85.06,-180,85.06,180]],ID["EPSG",3857]]</dd><dt><span>crs_wkt :</span></dt><dd>PROJCRS["WGS 84 / Pseudo-Mercator",BASEGEOGCRS["WGS 84",ENSEMBLE["World Geodetic System 1984 ensemble",MEMBER["World Geodetic System 1984 (Transit)"],MEMBER["World Geodetic System 1984 (G730)"],MEMBER["World Geodetic System 1984 (G873)"],MEMBER["World Geodetic System 1984 (G1150)"],MEMBER["World Geodetic System 1984 (G1674)"],MEMBER["World Geodetic System 1984 (G1762)"],MEMBER["World Geodetic System 1984 (G2139)"],ELLIPSOID["WGS 84",6378137,298.257223563,LENGTHUNIT["metre",1]],ENSEMBLEACCURACY[2.0]],PRIMEM["Greenwich",0,ANGLEUNIT["degree",0.0174532925199433]],ID["EPSG",4326]],CONVERSION["Popular Visualisation Pseudo-Mercator",METHOD["Popular Visualisation Pseudo Mercator",ID["EPSG",1024]],PARAMETER["Latitude of natural origin",0,ANGLEUNIT["degree",0.0174532925199433],ID["EPSG",8801]],PARAMETER["Longitude of natural origin",0,ANGLEUNIT["degree",0.0174532925199433],ID["EPSG",8802]],PARAMETER["False easting",0,LENGTHUNIT["metre",1],ID["EPSG",8806]],PARAMETER["False northing",0,LENGTHUNIT["metre",1],ID["EPSG",8807]]],CS[Cartesian,2],AXIS["easting (X)",east,ORDER[1],LENGTHUNIT["metre",1]],AXIS["northing (Y)",north,ORDER[2],LENGTHUNIT["metre",1]],USAGE[SCOPE["Web mapping and visualisation."],AREA["World between 85.06°S and 85.06°N."],BBOX[-85.06,-180,85.06,180]],ID["EPSG",3857]]</dd><dt><span>GeoTransform :</span></dt><dd>-334080 320 0 6864000 0 -320</dd></dl></div><div class="xr-var-data"><pre>array(3857, dtype=int32)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">time</span></div><div class="xr-var-dims">(time)</div><div class="xr-var-dtype">datetime64[ns]</div><div class="xr-var-preview xr-preview">2023-06-15T11:16:53.575000 ... 2...</div><input id="attrs-7bc564a6-bd46-4170-870b-d80e2b282a2d" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-7bc564a6-bd46-4170-870b-d80e2b282a2d" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-c70311a8-fc05-4d28-b3c4-df268336b298" class="xr-var-data-in" type="checkbox"><label for="data-c70311a8-fc05-4d28-b3c4-df268336b298" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array(['2023-06-15T11:16:53.575000000', '2023-06-15T11:16:57.326000000',
       '2023-06-15T11:17:08.043000000', '2023-06-15T11:17:11.659000000'],
      dtype='datetime64[ns]')</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-72b3c3ca-ec23-4c2c-b3c0-e2247e1db67c" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-72b3c3ca-ec23-4c2c-b3c0-e2247e1db67c" class="xr-section-summary">Data variables: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>red</span></div><div class="xr-var-dims">(time, y, x)</div><div class="xr-var-dtype">uint16</div><div class="xr-var-preview xr-preview">dask.array&lt;chunksize=(1, 1074, 1072), meta=np.ndarray&gt;</div><input id="attrs-3d514c68-b162-4d13-a9d3-a8ae5026081f" class="xr-var-attrs-in" type="checkbox"><label for="attrs-3d514c68-b162-4d13-a9d3-a8ae5026081f" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-6d76b4f5-0d2e-4a8a-937e-eecf6d5e7a73" class="xr-var-data-in" type="checkbox"><label for="data-6d76b4f5-0d2e-4a8a-937e-eecf6d5e7a73" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>nodata :</span></dt><dd>0</dd></dl></div><div class="xr-var-data">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th></th>
<th data-quarto-table-cell-role="th">Array</th>
<th data-quarto-table-cell-role="th">Chunk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Bytes</td>
<td>8.78 MiB</td>
<td>2.20 MiB</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Shape</td>
<td>(4, 1074, 1072)</td>
<td>(1, 1074, 1072)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dask graph</td>
<td colspan="2">4 chunks in 1 graph layer</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Data type</td>
<td colspan="2">uint16 numpy.ndarray</td>
</tr>
</tbody>
</table></td>
<td><svg width="194" height="184" style="stroke:rgb(0,0,0);stroke-width:1">
<!-- Horizontal lines --> <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2"></line> <line x1="10" y1="120" x2="24" y2="134" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2"></line> <line x1="13" y1="3" x2="13" y2="123"></line> <line x1="17" y1="7" x2="17" y2="127"></line> <line x1="21" y1="11" x2="21" y2="131"></line> <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,134.9485979497544 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="10" y1="0" x2="129" y2="0" style="stroke-width:2"></line> <line x1="13" y1="3" x2="133" y2="3"></line> <line x1="17" y1="7" x2="137" y2="7"></line> <line x1="21" y1="11" x2="140" y2="11"></line> <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2"></line> <line x1="129" y1="0" x2="144" y2="14" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 129.77653631284915,0.0 144.72513426260355,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2"></line> <line x1="24" y1="134" x2="144" y2="134" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2"></line> <line x1="144" y1="14" x2="144" y2="134" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="24.9485979497544,14.948597949754403 144.72513426260355,14.948597949754403 144.72513426260355,134.9485979497544 24.9485979497544,134.9485979497544" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Text --> <text x="84.836866" y="154.948598" font-size="1.0rem" font-weight="100" text-anchor="middle">1072</text> <text x="164.725134" y="74.948598" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.725134,74.948598)">1074</text> <text x="7.474299" y="147.474299" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,147.474299)">4</text>
</svg></td>
</tr>
</tbody>
</table>
</div></li><li class="xr-var-item"><div class="xr-var-name"><span>green</span></div><div class="xr-var-dims">(time, y, x)</div><div class="xr-var-dtype">uint16</div><div class="xr-var-preview xr-preview">dask.array&lt;chunksize=(1, 1074, 1072), meta=np.ndarray&gt;</div><input id="attrs-c594cd1f-4a48-4487-a867-9839a8887965" class="xr-var-attrs-in" type="checkbox"><label for="attrs-c594cd1f-4a48-4487-a867-9839a8887965" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-5f2bf19c-8d0a-4142-9606-4387c93bc09e" class="xr-var-data-in" type="checkbox"><label for="data-5f2bf19c-8d0a-4142-9606-4387c93bc09e" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>nodata :</span></dt><dd>0</dd></dl></div><div class="xr-var-data">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th></th>
<th data-quarto-table-cell-role="th">Array</th>
<th data-quarto-table-cell-role="th">Chunk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Bytes</td>
<td>8.78 MiB</td>
<td>2.20 MiB</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Shape</td>
<td>(4, 1074, 1072)</td>
<td>(1, 1074, 1072)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dask graph</td>
<td colspan="2">4 chunks in 1 graph layer</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Data type</td>
<td colspan="2">uint16 numpy.ndarray</td>
</tr>
</tbody>
</table></td>
<td><svg width="194" height="184" style="stroke:rgb(0,0,0);stroke-width:1">
<!-- Horizontal lines --> <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2"></line> <line x1="10" y1="120" x2="24" y2="134" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2"></line> <line x1="13" y1="3" x2="13" y2="123"></line> <line x1="17" y1="7" x2="17" y2="127"></line> <line x1="21" y1="11" x2="21" y2="131"></line> <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,134.9485979497544 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="10" y1="0" x2="129" y2="0" style="stroke-width:2"></line> <line x1="13" y1="3" x2="133" y2="3"></line> <line x1="17" y1="7" x2="137" y2="7"></line> <line x1="21" y1="11" x2="140" y2="11"></line> <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2"></line> <line x1="129" y1="0" x2="144" y2="14" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 129.77653631284915,0.0 144.72513426260355,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2"></line> <line x1="24" y1="134" x2="144" y2="134" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2"></line> <line x1="144" y1="14" x2="144" y2="134" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="24.9485979497544,14.948597949754403 144.72513426260355,14.948597949754403 144.72513426260355,134.9485979497544 24.9485979497544,134.9485979497544" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Text --> <text x="84.836866" y="154.948598" font-size="1.0rem" font-weight="100" text-anchor="middle">1072</text> <text x="164.725134" y="74.948598" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.725134,74.948598)">1074</text> <text x="7.474299" y="147.474299" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,147.474299)">4</text>
</svg></td>
</tr>
</tbody>
</table>
</div></li><li class="xr-var-item"><div class="xr-var-name"><span>blue</span></div><div class="xr-var-dims">(time, y, x)</div><div class="xr-var-dtype">uint16</div><div class="xr-var-preview xr-preview">dask.array&lt;chunksize=(1, 1074, 1072), meta=np.ndarray&gt;</div><input id="attrs-743301d8-da44-4a52-920b-ec2aba42c346" class="xr-var-attrs-in" type="checkbox"><label for="attrs-743301d8-da44-4a52-920b-ec2aba42c346" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-dd0e6811-a482-4c0f-9a9a-fcf23f43a91c" class="xr-var-data-in" type="checkbox"><label for="data-dd0e6811-a482-4c0f-9a9a-fcf23f43a91c" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>nodata :</span></dt><dd>0</dd></dl></div><div class="xr-var-data">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th></th>
<th data-quarto-table-cell-role="th">Array</th>
<th data-quarto-table-cell-role="th">Chunk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Bytes</td>
<td>8.78 MiB</td>
<td>2.20 MiB</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Shape</td>
<td>(4, 1074, 1072)</td>
<td>(1, 1074, 1072)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dask graph</td>
<td colspan="2">4 chunks in 1 graph layer</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Data type</td>
<td colspan="2">uint16 numpy.ndarray</td>
</tr>
</tbody>
</table></td>
<td><svg width="194" height="184" style="stroke:rgb(0,0,0);stroke-width:1">
<!-- Horizontal lines --> <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2"></line> <line x1="10" y1="120" x2="24" y2="134" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2"></line> <line x1="13" y1="3" x2="13" y2="123"></line> <line x1="17" y1="7" x2="17" y2="127"></line> <line x1="21" y1="11" x2="21" y2="131"></line> <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,134.9485979497544 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="10" y1="0" x2="129" y2="0" style="stroke-width:2"></line> <line x1="13" y1="3" x2="133" y2="3"></line> <line x1="17" y1="7" x2="137" y2="7"></line> <line x1="21" y1="11" x2="140" y2="11"></line> <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2"></line> <line x1="129" y1="0" x2="144" y2="14" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 129.77653631284915,0.0 144.72513426260355,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2"></line> <line x1="24" y1="134" x2="144" y2="134" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2"></line> <line x1="144" y1="14" x2="144" y2="134" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="24.9485979497544,14.948597949754403 144.72513426260355,14.948597949754403 144.72513426260355,134.9485979497544 24.9485979497544,134.9485979497544" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Text --> <text x="84.836866" y="154.948598" font-size="1.0rem" font-weight="100" text-anchor="middle">1072</text> <text x="164.725134" y="74.948598" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.725134,74.948598)">1074</text> <text x="7.474299" y="147.474299" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,147.474299)">4</text>
</svg></td>
</tr>
</tbody>
</table>
</div></li></ul></div></li><li class="xr-section-item"><input id="section-95abb197-9930-41fe-9c1b-01abd1aae92e" class="xr-section-summary-in" type="checkbox"><label for="section-95abb197-9930-41fe-9c1b-01abd1aae92e" class="xr-section-summary">Indexes: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>y</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-13f6dd27-54a4-4aa4-a3fc-2485cd3e4366" class="xr-index-data-in" type="checkbox"><label for="index-13f6dd27-54a4-4aa4-a3fc-2485cd3e4366" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([6863840.0, 6863520.0, 6863200.0, 6862880.0, 6862560.0, 6862240.0,
       6861920.0, 6861600.0, 6861280.0, 6860960.0,
       ...
       6523360.0, 6523040.0, 6522720.0, 6522400.0, 6522080.0, 6521760.0,
       6521440.0, 6521120.0, 6520800.0, 6520480.0],
      dtype='float64', name='y', length=1074))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>x</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-728fc239-14f2-4b9e-9a54-3939cbee1566" class="xr-index-data-in" type="checkbox"><label for="index-728fc239-14f2-4b9e-9a54-3939cbee1566" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([-333920.0, -333600.0, -333280.0, -332960.0, -332640.0, -332320.0,
       -332000.0, -331680.0, -331360.0, -331040.0,
       ...
          5920.0,    6240.0,    6560.0,    6880.0,    7200.0,    7520.0,
          7840.0,    8160.0,    8480.0,    8800.0],
      dtype='float64', name='x', length=1072))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>time</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-bfe5898c-236f-4a2b-96c5-14ac93878aaf" class="xr-index-data-in" type="checkbox"><label for="index-bfe5898c-236f-4a2b-96c5-14ac93878aaf" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(DatetimeIndex(['2023-06-15 11:16:53.575000', '2023-06-15 11:16:57.326000',
               '2023-06-15 11:17:08.043000', '2023-06-15 11:17:11.659000'],
              dtype='datetime64[ns]', name='time', freq=None))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-a9afd0ad-9142-4c10-94fa-bb2391616b4a" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-a9afd0ad-9142-4c10-94fa-bb2391616b4a" class="xr-section-summary" title="Expand/collapse section">Attributes: <span>(0)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"></dl></div></li></ul></div></div>
</div>
</div>
<div id="379a9f4d-413b-4647-bed9-69c6f648756b" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>xx <span class="op">=</span> xx.compute() <span class="co"># LOAD INTO LOCAL MEMORY</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: user 623 ms, sys: 126 ms, total: 749 ms
Wall time: 10.3 s</code></pre>
</div>
</div>
<div id="96b83159-92e5-4ea4-b293-ace0500b3d04" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> (</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    xx.isel(time<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    .to_array(<span class="st">"band"</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    .plot.imshow(</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>        col<span class="op">=</span><span class="st">"band"</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>        size<span class="op">=</span><span class="dv">4</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>        vmin<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>        vmax<span class="op">=</span><span class="dv">4000</span>,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="cubes_files/figure-html/cell-26-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="45fbcad0-04cb-4c0d-b7ae-e4bb510831a8" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rework to show the area around Harwell campus</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="fl">6.5</span> <span class="op">*</span> km2deg</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>small_bbox <span class="op">=</span> (x <span class="op">-</span> r, y <span class="op">-</span> r, x <span class="op">+</span> r, y <span class="op">+</span> r)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>yy <span class="op">=</span> stac_load(</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    items,</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    bands<span class="op">=</span>(<span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>),</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    crs<span class="op">=</span>crs,</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    resolution<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    chunks<span class="op">=</span>{},  <span class="co"># &lt;-- use Dask</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    bbox<span class="op">=</span>small_bbox,</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>yy <span class="op">=</span> yy.compute()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d065e5f7-0778-4e42-afbb-8ccec9073fa2" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> (</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    yy.isel(time<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    .to_array(<span class="st">"band"</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    .plot.imshow(</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>        col<span class="op">=</span><span class="st">"band"</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>        size<span class="op">=</span><span class="dv">4</span>,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>        vmin<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>        vmax<span class="op">=</span><span class="dv">4000</span>,</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="cubes_files/figure-html/cell-28-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="odc-stac-and-ceda-ard" class="level1">
<h1>ODC-STAC and CEDA ARD</h1>
<p>Once again we have a look at using the CEDA STAC.</p>
<div id="ac056347-5fb2-4e95-98ed-57ec504928e4" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SEARCH</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>catalog <span class="op">=</span> Client.<span class="bu">open</span>(CURL)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> catalog.search(</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    collections<span class="op">=</span>[<span class="st">"sentinel2_ard"</span>], datetime<span class="op">=</span><span class="st">"2023-06-15"</span>, limit<span class="op">=</span><span class="dv">100</span>, bbox<span class="op">=</span>bbox</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>items <span class="op">=</span> <span class="bu">list</span>(query.items())</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Found: </span><span class="sc">{</span><span class="bu">len</span>(items)<span class="sc">:d}</span><span class="ss"> datasets"</span>)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert STAC items into a GeoJSON FeatureCollection</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>stac_json <span class="op">=</span> query.item_collection_as_dict()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Found: 4 datasets</code></pre>
</div>
</div>
<div id="0288e451-47c0-4b19-b770-e80dcac7b120" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> key, value <span class="kw">in</span> items[<span class="dv">1</span>].assets.items():</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(key, value.href)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>cloud https://dap.ceda.ac.uk/neodc/sentinel_ard/data/sentinel_2/2023/06/15/S2B_20230615_latn518lonw0008_T30UXC_ORB137_20230615131239_utm30n_osgb_clouds.tif
cloud_probability https://dap.ceda.ac.uk/neodc/sentinel_ard/data/sentinel_2/2023/06/15/S2B_20230615_latn518lonw0008_T30UXC_ORB137_20230615131239_utm30n_osgb_clouds_prob.tif
metadata https://dap.ceda.ac.uk/neodc/sentinel_ard/data/sentinel_2/2023/06/15/S2B_20230615_latn518lonw0008_T30UXC_ORB137_20230615131239_utm30n_osgb_vmsk_sharp_rad_srefdem_stdsref_meta.xml
thumbnail https://dap.ceda.ac.uk/neodc/sentinel_ard/data/sentinel_2/2023/06/15/S2B_20230615_latn518lonw0008_T30UXC_ORB137_20230615131239_utm30n_osgb_vmsk_sharp_rad_srefdem_stdsref_thumbnail.jpg
topographic_shadow https://dap.ceda.ac.uk/neodc/sentinel_ard/data/sentinel_2/2023/06/15/S2B_20230615_latn518lonw0008_T30UXC_ORB137_20230615131239_utm30n_osgb_toposhad.tif
cog https://dap.ceda.ac.uk/neodc/sentinel_ard/data/sentinel_2/2023/06/15/S2B_20230615_latn518lonw0008_T30UXC_ORB137_20230615131239_utm30n_osgb_vmsk_sharp_rad_srefdem_stdsref.tif
valid_pixels https://dap.ceda.ac.uk/neodc/sentinel_ard/data/sentinel_2/2023/06/15/S2B_20230615_latn518lonw0008_T30UXC_ORB137_20230615131239_utm30n_osgb_valid.tif
saturated_pixels https://dap.ceda.ac.uk/neodc/sentinel_ard/data/sentinel_2/2023/06/15/S2B_20230615_latn518lonw0008_T30UXC_ORB137_20230615131239_utm30n_osgb_sat.tif</code></pre>
</div>
</div>
<div id="27f6e12a-93aa-4a70-8cd6-92232cd835a9" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># REVIEW SEARCH RESULTS</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>gdf2 <span class="op">=</span> gpd.GeoDataFrame.from_features(stac_json, <span class="st">"epsg:4326"</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> folium.Figure(width<span class="op">=</span><span class="dv">600</span>, height<span class="op">=</span><span class="dv">400</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> folium.Map(location<span class="op">=</span>[<span class="dv">52</span>, <span class="dv">2</span>], zoom_start<span class="op">=</span><span class="dv">5</span>).add_to(f)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>gdf2.explore(</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"esa_file_name"</span>,</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>    categorical<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>    tooltip<span class="op">=</span>[</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"esa_file_name"</span>,</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>    popup<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"STAC"</span>,</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>    m<span class="op">=</span>m,</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<iframe srcdoc="<!DOCTYPE html>
<html>
<head>
    
    <meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; />
    
        <script>
            L_NO_TOUCH = false;
            L_DISABLE_3D = false;
        </script>
    
    <style>html, body {width: 100%;height: 100%;margin: 0;padding: 0;}</style>
    <style>#map {position:absolute;top:0;bottom:0;right:0;left:0;}</style>
    <script src=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js&quot;></script>
    <script src=&quot;https://code.jquery.com/jquery-3.7.1.min.js&quot;></script>
    <script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js&quot;></script>
    <script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js&quot;></script>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css&quot;/>
    
            <meta name=&quot;viewport&quot; content=&quot;width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot; />
            <style>
                #map_b77fb90f1054eba951fc7f586b6ba282 {
                    position: relative;
                    width: 100.0%;
                    height: 100.0%;
                    left: 0.0%;
                    top: 0.0%;
                }
                .leaflet-container { font-size: 1rem; }
            </style>
        
    
                    <style>
                        .foliumtooltip {
                            
                        }
                       .foliumtooltip table{
                            margin: auto;
                        }
                        .foliumtooltip tr{
                            text-align: left;
                        }
                        .foliumtooltip th{
                            padding: 2px; padding-right: 8px;
                        }
                    </style>
            
    
    <script src=&quot;https://code.jquery.com/ui/1.12.1/jquery-ui.js&quot;></script>
    <script>$( function() {
        $( &quot;.maplegend&quot; ).draggable({
            start: function (event, ui) {
                $(this).css({
                    right: &quot;auto&quot;,
                    top: &quot;auto&quot;,
                    bottom: &quot;auto&quot;
                });
            }
        });
    });
    </script>
    <style type='text/css'>
      .maplegend {
        position: absolute;
        z-index:9999;
        background-color: rgba(255, 255, 255, .8);
        border-radius: 5px;
        box-shadow: 0 0 15px rgba(0,0,0,0.2);
        padding: 10px;
        font: 12px/14px Arial, Helvetica, sans-serif;
        right: 10px;
        bottom: 20px;
      }
      .maplegend .legend-title {
        text-align: left;
        margin-bottom: 5px;
        font-weight: bold;
        }
      .maplegend .legend-scale ul {
        margin: 0;
        margin-bottom: 0px;
        padding: 0;
        float: left;
        list-style: none;
        }
      .maplegend .legend-scale ul li {
        list-style: none;
        margin-left: 0;
        line-height: 16px;
        margin-bottom: 2px;
        }
      .maplegend ul.legend-labels li span {
        display: block;
        float: left;
        height: 14px;
        width: 14px;
        margin-right: 5px;
        margin-left: 0;
        border: 0px solid #ccc;
        }
      .maplegend .legend-source {
        color: #777;
        clear: both;
        }
      .maplegend a {
        color: #777;
        }
    </style>
    
</head>
<body>
    
    
    <div id='maplegend esa_file_name' class='maplegend'>
        <div class='legend-title'>esa_file_name</div>
        <div class='legend-scale'>
            <ul class='legend-labels'>
                <li><span style='background:#1f77b4'></span>S2B_MSIL1C_20230615T110629_N0509_R137_T30UWB_20230615T131239</li>
                <li><span style='background:#d62728'></span>S2B_MSIL1C_20230615T110629_N0509_R137_T30UWC_20230615T131239</li>
                <li><span style='background:#f7b6d2'></span>S2B_MSIL1C_20230615T110629_N0509_R137_T30UXB_20230615T131239</li>
                <li><span style='background:#9edae5'></span>S2B_MSIL1C_20230615T110629_N0509_R137_T30UXC_20230615T131239</li>
            </ul>
        </div>
    </div>
    
    
            <div class=&quot;folium-map&quot; id=&quot;map_b77fb90f1054eba951fc7f586b6ba282&quot; ></div>
        
</body>
<script>
    
    
            var map_b77fb90f1054eba951fc7f586b6ba282 = L.map(
                &quot;map_b77fb90f1054eba951fc7f586b6ba282&quot;,
                {
                    center: [52.0, 2.0],
                    crs: L.CRS.EPSG3857,
                    zoom: 5,
                    zoomControl: true,
                    preferCanvas: false,
                }
            );

            

        
    
            var tile_layer_0dc72cfe1942bd50e46e04daad98d2fd = L.tileLayer(
                &quot;https://tile.openstreetmap.org/{z}/{x}/{y}.png&quot;,
                {&quot;attribution&quot;: &quot;\u0026copy; \u003ca href=\&quot;https://www.openstreetmap.org/copyright\&quot;\u003eOpenStreetMap\u003c/a\u003e contributors&quot;, &quot;detectRetina&quot;: false, &quot;maxNativeZoom&quot;: 19, &quot;maxZoom&quot;: 19, &quot;minZoom&quot;: 0, &quot;noWrap&quot;: false, &quot;opacity&quot;: 1, &quot;subdomains&quot;: &quot;abc&quot;, &quot;tms&quot;: false}
            );
        
    
            tile_layer_0dc72cfe1942bd50e46e04daad98d2fd.addTo(map_b77fb90f1054eba951fc7f586b6ba282);
        
    
        function geo_json_5eacdae7db0b98101659fb494c627283_styler(feature) {
            switch(feature.id) {
                case &quot;0&quot;: 
                    return {&quot;color&quot;: &quot;#d62728&quot;, &quot;fillColor&quot;: &quot;#d62728&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 2};
                case &quot;1&quot;: 
                    return {&quot;color&quot;: &quot;#9edae5&quot;, &quot;fillColor&quot;: &quot;#9edae5&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 2};
                case &quot;2&quot;: 
                    return {&quot;color&quot;: &quot;#1f77b4&quot;, &quot;fillColor&quot;: &quot;#1f77b4&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 2};
                default:
                    return {&quot;color&quot;: &quot;#f7b6d2&quot;, &quot;fillColor&quot;: &quot;#f7b6d2&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 2};
            }
        }
        function geo_json_5eacdae7db0b98101659fb494c627283_highlighter(feature) {
            switch(feature.id) {
                default:
                    return {&quot;fillOpacity&quot;: 0.75};
            }
        }
        function geo_json_5eacdae7db0b98101659fb494c627283_pointToLayer(feature, latlng) {
            var opts = {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;#3388ff&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;#3388ff&quot;, &quot;fillOpacity&quot;: 0.2, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 2, &quot;stroke&quot;: true, &quot;weight&quot;: 3};
            
            let style = geo_json_5eacdae7db0b98101659fb494c627283_styler(feature)
            Object.assign(opts, style)
            
            return new L.CircleMarker(latlng, opts)
        }

        function geo_json_5eacdae7db0b98101659fb494c627283_onEachFeature(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    if(typeof e.target.setStyle === &quot;function&quot;){
                            geo_json_5eacdae7db0b98101659fb494c627283.resetStyle(e.target);
                    }
                },
                mouseover: function(e) {
                    if(typeof e.target.setStyle === &quot;function&quot;){
                        const highlightStyle = geo_json_5eacdae7db0b98101659fb494c627283_highlighter(e.target.feature)
                        e.target.setStyle(highlightStyle);
                    }
                },
            });
        };
        var geo_json_5eacdae7db0b98101659fb494c627283 = L.geoJson(null, {
                onEachFeature: geo_json_5eacdae7db0b98101659fb494c627283_onEachFeature,
            
                style: geo_json_5eacdae7db0b98101659fb494c627283_styler,
                pointToLayer: geo_json_5eacdae7db0b98101659fb494c627283_pointToLayer,
        });

        function geo_json_5eacdae7db0b98101659fb494c627283_add (data) {
            geo_json_5eacdae7db0b98101659fb494c627283
                .addData(data);
        }
            geo_json_5eacdae7db0b98101659fb494c627283_add({&quot;bbox&quot;: [-3.0002747, 50.42629366061962, 0.077757925309447, 52.34847643359674], &quot;features&quot;: [{&quot;bbox&quot;: [-3.0002747, 51.35263389325745, -1.3886108, 52.34847643359674], &quot;geometry&quot;: {&quot;coordinates&quot;: [[[-3.0002747, 51.65065247927002], [-2.9639893, 51.73806237456057], [-2.9032288, 51.88375649040668], [-2.8423767, 52.029495749256775], [-2.7809143, 52.175145612135694], [-2.7192993, 52.320791623760165], [-2.707428, 52.34847643359674], [-1.3886108, 52.3394848521498], [-1.4234924, 51.35263389325745], [-3.0002747, 51.36324170782969], [-3.0002747, 51.65065247927002]]], &quot;type&quot;: &quot;Polygon&quot;}, &quot;id&quot;: &quot;0&quot;, &quot;properties&quot;: {&quot;Datatake Type&quot;: &quot;INS-NOBS&quot;, &quot;EPSG&quot;: &quot;27700&quot;, &quot;Ground Tracking Direction&quot;: &quot;ascending&quot;, &quot;Instrument Family Name&quot;: &quot;Multi-Spectral Instrument&quot;, &quot;Instrument Family Name Abbreviation&quot;: &quot;MSI&quot;, &quot;Instrument Mode&quot;: null, &quot;NSSDC Identifier&quot;: &quot;2015-000A&quot;, &quot;Platform Number&quot;: &quot;2B&quot;, &quot;Product Type&quot;: &quot;S2MSI1C&quot;, &quot;Start Orbit Number&quot;: &quot;032767&quot;, &quot;Start Relative Orbit Number&quot;: &quot;137&quot;, &quot;__folium_color&quot;: &quot;#d62728&quot;, &quot;created&quot;: &quot;2024-02-07T12:20:34.595471Z&quot;, &quot;datetime&quot;: &quot;2023-06-15T11:06:29Z&quot;, &quot;end_datetime&quot;: &quot;2023-06-15T11:06:29Z&quot;, &quot;eo:cloud_cover&quot;: &quot;48.6950565710092&quot;, &quot;esa_file_name&quot;: &quot;S2B_MSIL1C_20230615T110629_N0509_R137_T30UWC_20230615T131239&quot;, &quot;file_count&quot;: 8, &quot;instance_id&quot;: &quot;neodc.sentinel_ard.data.sentinel_2.2023.06.15.S2B_20230615_latn519lonw0022_T30UWC_ORB137_20230615131239_utm30n_osgb&quot;, &quot;size&quot;: 1940359829, &quot;start_datetime&quot;: &quot;2023-06-15T11:06:29Z&quot;, &quot;updated&quot;: &quot;2024-02-07T12:20:34.595471Z&quot;}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-1.5638733, 51.32452335478603, 0.077757925309447, 52.34135509726958], &quot;geometry&quot;: {&quot;coordinates&quot;: [[[-1.5321045, 52.34135509726958], [0.077757925309447, 52.31036691499413], [0.011254122594852, 51.32452335478603], [-1.5638733, 51.354439390266904], [-1.5321045, 52.34135509726958]]], &quot;type&quot;: &quot;Polygon&quot;}, &quot;id&quot;: &quot;1&quot;, &quot;properties&quot;: {&quot;Datatake Type&quot;: &quot;INS-NOBS&quot;, &quot;EPSG&quot;: &quot;27700&quot;, &quot;Ground Tracking Direction&quot;: &quot;ascending&quot;, &quot;Instrument Family Name&quot;: &quot;Multi-Spectral Instrument&quot;, &quot;Instrument Family Name Abbreviation&quot;: &quot;MSI&quot;, &quot;Instrument Mode&quot;: null, &quot;NSSDC Identifier&quot;: &quot;2015-000A&quot;, &quot;Platform Number&quot;: &quot;2B&quot;, &quot;Product Type&quot;: &quot;S2MSI1C&quot;, &quot;Start Orbit Number&quot;: &quot;032767&quot;, &quot;Start Relative Orbit Number&quot;: &quot;137&quot;, &quot;__folium_color&quot;: &quot;#9edae5&quot;, &quot;created&quot;: &quot;2024-02-07T12:20:32.968742Z&quot;, &quot;datetime&quot;: &quot;2023-06-15T11:06:29Z&quot;, &quot;end_datetime&quot;: &quot;2023-06-15T11:06:29Z&quot;, &quot;eo:cloud_cover&quot;: &quot;49.1430917614739&quot;, &quot;esa_file_name&quot;: &quot;S2B_MSIL1C_20230615T110629_N0509_R137_T30UXC_20230615T131239&quot;, &quot;file_count&quot;: 8, &quot;instance_id&quot;: &quot;neodc.sentinel_ard.data.sentinel_2.2023.06.15.S2B_20230615_latn518lonw0008_T30UXC_ORB137_20230615131239_utm30n_osgb&quot;, &quot;size&quot;: 2096421365, &quot;start_datetime&quot;: &quot;2023-06-15T11:06:29Z&quot;, &quot;updated&quot;: &quot;2024-02-07T12:20:32.968742Z&quot;}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-3.0002747, 50.453523278919015, -1.4204712, 51.45118220579359], &quot;geometry&quot;: {&quot;coordinates&quot;: [[[-3.0002747, 51.45118220579359], [-1.4204712, 51.44054116582309], [-1.4535522, 50.453523278919015], [-3.0002747, 50.46379840175528], [-3.0002747, 51.45118220579359]]], &quot;type&quot;: &quot;Polygon&quot;}, &quot;id&quot;: &quot;2&quot;, &quot;properties&quot;: {&quot;Datatake Type&quot;: &quot;INS-NOBS&quot;, &quot;EPSG&quot;: &quot;27700&quot;, &quot;Ground Tracking Direction&quot;: &quot;ascending&quot;, &quot;Instrument Family Name&quot;: &quot;Multi-Spectral Instrument&quot;, &quot;Instrument Family Name Abbreviation&quot;: &quot;MSI&quot;, &quot;Instrument Mode&quot;: null, &quot;NSSDC Identifier&quot;: &quot;2015-000A&quot;, &quot;Platform Number&quot;: &quot;2B&quot;, &quot;Product Type&quot;: &quot;S2MSI1C&quot;, &quot;Start Orbit Number&quot;: &quot;032767&quot;, &quot;Start Relative Orbit Number&quot;: &quot;137&quot;, &quot;__folium_color&quot;: &quot;#1f77b4&quot;, &quot;created&quot;: &quot;2024-02-07T12:20:30.284574Z&quot;, &quot;datetime&quot;: &quot;2023-06-15T11:06:29Z&quot;, &quot;end_datetime&quot;: &quot;2023-06-15T11:06:29Z&quot;, &quot;eo:cloud_cover&quot;: &quot;3.85571381647705&quot;, &quot;esa_file_name&quot;: &quot;S2B_MSIL1C_20230615T110629_N0509_R137_T30UWB_20230615T131239&quot;, &quot;file_count&quot;: 8, &quot;instance_id&quot;: &quot;neodc.sentinel_ard.data.sentinel_2.2023.06.15.S2B_20230615_latn510lonw0022_T30UWB_ORB137_20230615131239_utm30n_osgb&quot;, &quot;size&quot;: 1804964724, &quot;start_datetime&quot;: &quot;2023-06-15T11:06:29Z&quot;, &quot;updated&quot;: &quot;2024-02-07T12:20:30.284574Z&quot;}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-1.5912781, 50.42629366061962, 0.017025008525814, 51.44235231685392], &quot;geometry&quot;: {&quot;coordinates&quot;: [[[-1.5611267, 51.44235231685392], [0.017025008525814, 51.41234265506691], [-0.046142578, 50.42629366061962], [-1.5912781, 50.45527216066188], [-1.5611267, 51.44235231685392]]], &quot;type&quot;: &quot;Polygon&quot;}, &quot;id&quot;: &quot;3&quot;, &quot;properties&quot;: {&quot;Datatake Type&quot;: &quot;INS-NOBS&quot;, &quot;EPSG&quot;: &quot;27700&quot;, &quot;Ground Tracking Direction&quot;: &quot;ascending&quot;, &quot;Instrument Family Name&quot;: &quot;Multi-Spectral Instrument&quot;, &quot;Instrument Family Name Abbreviation&quot;: &quot;MSI&quot;, &quot;Instrument Mode&quot;: null, &quot;NSSDC Identifier&quot;: &quot;2015-000A&quot;, &quot;Platform Number&quot;: &quot;2B&quot;, &quot;Product Type&quot;: &quot;S2MSI1C&quot;, &quot;Start Orbit Number&quot;: &quot;032767&quot;, &quot;Start Relative Orbit Number&quot;: &quot;137&quot;, &quot;__folium_color&quot;: &quot;#f7b6d2&quot;, &quot;created&quot;: &quot;2024-02-07T12:20:29.057200Z&quot;, &quot;datetime&quot;: &quot;2023-06-15T11:06:29Z&quot;, &quot;end_datetime&quot;: &quot;2023-06-15T11:06:29Z&quot;, &quot;eo:cloud_cover&quot;: &quot;36.9488787363015&quot;, &quot;esa_file_name&quot;: &quot;S2B_MSIL1C_20230615T110629_N0509_R137_T30UXB_20230615T131239&quot;, &quot;file_count&quot;: 8, &quot;instance_id&quot;: &quot;neodc.sentinel_ard.data.sentinel_2.2023.06.15.S2B_20230615_latn509lonw0008_T30UXB_ORB137_20230615131239_utm30n_osgb&quot;, &quot;size&quot;: 1666595186, &quot;start_datetime&quot;: &quot;2023-06-15T11:06:29Z&quot;, &quot;updated&quot;: &quot;2024-02-07T12:20:29.057200Z&quot;}, &quot;type&quot;: &quot;Feature&quot;}], &quot;type&quot;: &quot;FeatureCollection&quot;});

        
    
    geo_json_5eacdae7db0b98101659fb494c627283.bindTooltip(
    function(layer){
    let div = L.DomUtil.create('div');
    
    let handleObject = feature=>typeof(feature)=='object' ? JSON.stringify(feature) : feature;
    let fields = [&quot;esa_file_name&quot;];
    let aliases = [&quot;esa_file_name&quot;];
    let table = '<table>' +
        String(
        fields.map(
        (v,i)=>
        `<tr>
            <th>${aliases[i]}</th>
            
            <td>${handleObject(layer.feature.properties[v])}</td>
        </tr>`).join(''))
    +'</table>';
    div.innerHTML=table;
    
    return div
    }
    ,{&quot;className&quot;: &quot;foliumtooltip&quot;, &quot;sticky&quot;: true});
                     
    
            geo_json_5eacdae7db0b98101659fb494c627283.addTo(map_b77fb90f1054eba951fc7f586b6ba282);
        
</script>
</html>" width="600" height="400" style="border:none !important;" "allowfullscreen"="" "webkitallowfullscreen"="" "mozallowfullscreen"=""></iframe>
</div>
</div>
<div id="62d75baf-45ad-4a24-a7ed-329917e13041" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CONSTRUCT DASK DATASET</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Since we will plot it on a map we need to use `EPSG:3857` projection</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>crs <span class="op">=</span> <span class="st">"epsg:3857"</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>zoom <span class="op">=</span> <span class="dv">2</span><span class="op">**</span><span class="dv">5</span>  <span class="co"># overview level 5</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>cx <span class="op">=</span> stac_load(</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    items,</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    crs<span class="op">=</span>crs,</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    resolution<span class="op">=</span><span class="dv">10</span> <span class="op">*</span> zoom,</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    chunks<span class="op">=</span>{<span class="st">"x"</span>: <span class="dv">2048</span>, <span class="st">"y"</span>: <span class="dv">2048</span>},  <span class="co"># &lt;-- use Dask</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Bands: </span><span class="sc">{</span><span class="st">','</span><span class="sc">.</span>join(<span class="bu">list</span>(xx.data_vars))<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>display(cx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bands: red,green,blue</code></pre>
</div>
<div class="cell-output cell-output-display">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt; Size: 32MB
Dimensions:             (y: 1073, x: 1072, time: 1)
Coordinates:
  * y                   (y) float64 9kB 6.864e+06 6.863e+06 ... 6.52e+06
  * x                   (x) float64 9kB -3.339e+05 -3.336e+05 ... 8.8e+03
    spatial_ref         int32 4B 3857
  * time                (time) datetime64[ns] 8B 2023-06-15T11:06:29
Data variables:
    cloud               (time, y, x) float32 5MB dask.array&lt;chunksize=(1, 1073, 1072), meta=np.ndarray&gt;
    cloud_probability   (time, y, x) float32 5MB dask.array&lt;chunksize=(1, 1073, 1072), meta=np.ndarray&gt;
    thumbnail           (time, y, x) float32 5MB dask.array&lt;chunksize=(1, 1073, 1072), meta=np.ndarray&gt;
    topographic_shadow  (time, y, x) float32 5MB dask.array&lt;chunksize=(1, 1073, 1072), meta=np.ndarray&gt;
    cog                 (time, y, x) float32 5MB dask.array&lt;chunksize=(1, 1073, 1072), meta=np.ndarray&gt;
    valid_pixels        (time, y, x) float32 5MB dask.array&lt;chunksize=(1, 1073, 1072), meta=np.ndarray&gt;
    saturated_pixels    (time, y, x) float32 5MB dask.array&lt;chunksize=(1, 1073, 1072), meta=np.ndarray&gt;</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-ba2a896c-6b79-4e1b-b30c-caa386683d8b" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-ba2a896c-6b79-4e1b-b30c-caa386683d8b" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">y</span>: 1073</li><li><span class="xr-has-index">x</span>: 1072</li><li><span class="xr-has-index">time</span>: 1</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-045f77cb-de9a-4d98-a8cc-9eb0512c0068" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-045f77cb-de9a-4d98-a8cc-9eb0512c0068" class="xr-section-summary">Coordinates: <span>(4)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">y</span></div><div class="xr-var-dims">(y)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">6.864e+06 6.863e+06 ... 6.52e+06</div><input id="attrs-0e884381-18af-4efe-8a14-09852ecf7971" class="xr-var-attrs-in" type="checkbox"><label for="attrs-0e884381-18af-4efe-8a14-09852ecf7971" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-5f6336cb-9ad4-438f-943f-73334566fca1" class="xr-var-data-in" type="checkbox"><label for="data-5f6336cb-9ad4-438f-943f-73334566fca1" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>units :</span></dt><dd>metre</dd><dt><span>resolution :</span></dt><dd>-320.0</dd><dt><span>crs :</span></dt><dd>EPSG:3857</dd></dl></div><div class="xr-var-data"><pre>array([6863520., 6863200., 6862880., ..., 6521120., 6520800., 6520480.])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">x</span></div><div class="xr-var-dims">(x)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-3.339e+05 -3.336e+05 ... 8.8e+03</div><input id="attrs-e2265ddf-3c39-45d2-b9c6-9659835198a1" class="xr-var-attrs-in" type="checkbox"><label for="attrs-e2265ddf-3c39-45d2-b9c6-9659835198a1" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-8f187797-f2d4-4674-a641-a3683d3e9327" class="xr-var-data-in" type="checkbox"><label for="data-8f187797-f2d4-4674-a641-a3683d3e9327" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>units :</span></dt><dd>metre</dd><dt><span>resolution :</span></dt><dd>320.0</dd><dt><span>crs :</span></dt><dd>EPSG:3857</dd></dl></div><div class="xr-var-data"><pre>array([-333920., -333600., -333280., ...,    8160.,    8480.,    8800.])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>spatial_ref</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">int32</div><div class="xr-var-preview xr-preview">3857</div><input id="attrs-ea6fd208-0fde-4836-84ff-960c788f2cd3" class="xr-var-attrs-in" type="checkbox"><label for="attrs-ea6fd208-0fde-4836-84ff-960c788f2cd3" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-adf7392b-a5da-4467-bf7f-f0d62256300b" class="xr-var-data-in" type="checkbox"><label for="data-adf7392b-a5da-4467-bf7f-f0d62256300b" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>spatial_ref :</span></dt><dd>PROJCRS["WGS 84 / Pseudo-Mercator",BASEGEOGCRS["WGS 84",ENSEMBLE["World Geodetic System 1984 ensemble",MEMBER["World Geodetic System 1984 (Transit)"],MEMBER["World Geodetic System 1984 (G730)"],MEMBER["World Geodetic System 1984 (G873)"],MEMBER["World Geodetic System 1984 (G1150)"],MEMBER["World Geodetic System 1984 (G1674)"],MEMBER["World Geodetic System 1984 (G1762)"],MEMBER["World Geodetic System 1984 (G2139)"],ELLIPSOID["WGS 84",6378137,298.257223563,LENGTHUNIT["metre",1]],ENSEMBLEACCURACY[2.0]],PRIMEM["Greenwich",0,ANGLEUNIT["degree",0.0174532925199433]],ID["EPSG",4326]],CONVERSION["Popular Visualisation Pseudo-Mercator",METHOD["Popular Visualisation Pseudo Mercator",ID["EPSG",1024]],PARAMETER["Latitude of natural origin",0,ANGLEUNIT["degree",0.0174532925199433],ID["EPSG",8801]],PARAMETER["Longitude of natural origin",0,ANGLEUNIT["degree",0.0174532925199433],ID["EPSG",8802]],PARAMETER["False easting",0,LENGTHUNIT["metre",1],ID["EPSG",8806]],PARAMETER["False northing",0,LENGTHUNIT["metre",1],ID["EPSG",8807]]],CS[Cartesian,2],AXIS["easting (X)",east,ORDER[1],LENGTHUNIT["metre",1]],AXIS["northing (Y)",north,ORDER[2],LENGTHUNIT["metre",1]],USAGE[SCOPE["Web mapping and visualisation."],AREA["World between 85.06°S and 85.06°N."],BBOX[-85.06,-180,85.06,180]],ID["EPSG",3857]]</dd><dt><span>crs_wkt :</span></dt><dd>PROJCRS["WGS 84 / Pseudo-Mercator",BASEGEOGCRS["WGS 84",ENSEMBLE["World Geodetic System 1984 ensemble",MEMBER["World Geodetic System 1984 (Transit)"],MEMBER["World Geodetic System 1984 (G730)"],MEMBER["World Geodetic System 1984 (G873)"],MEMBER["World Geodetic System 1984 (G1150)"],MEMBER["World Geodetic System 1984 (G1674)"],MEMBER["World Geodetic System 1984 (G1762)"],MEMBER["World Geodetic System 1984 (G2139)"],ELLIPSOID["WGS 84",6378137,298.257223563,LENGTHUNIT["metre",1]],ENSEMBLEACCURACY[2.0]],PRIMEM["Greenwich",0,ANGLEUNIT["degree",0.0174532925199433]],ID["EPSG",4326]],CONVERSION["Popular Visualisation Pseudo-Mercator",METHOD["Popular Visualisation Pseudo Mercator",ID["EPSG",1024]],PARAMETER["Latitude of natural origin",0,ANGLEUNIT["degree",0.0174532925199433],ID["EPSG",8801]],PARAMETER["Longitude of natural origin",0,ANGLEUNIT["degree",0.0174532925199433],ID["EPSG",8802]],PARAMETER["False easting",0,LENGTHUNIT["metre",1],ID["EPSG",8806]],PARAMETER["False northing",0,LENGTHUNIT["metre",1],ID["EPSG",8807]]],CS[Cartesian,2],AXIS["easting (X)",east,ORDER[1],LENGTHUNIT["metre",1]],AXIS["northing (Y)",north,ORDER[2],LENGTHUNIT["metre",1]],USAGE[SCOPE["Web mapping and visualisation."],AREA["World between 85.06°S and 85.06°N."],BBOX[-85.06,-180,85.06,180]],ID["EPSG",3857]]</dd><dt><span>GeoTransform :</span></dt><dd>-334080 320 0 6863680 0 -320</dd></dl></div><div class="xr-var-data"><pre>array(3857, dtype=int32)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">time</span></div><div class="xr-var-dims">(time)</div><div class="xr-var-dtype">datetime64[ns]</div><div class="xr-var-preview xr-preview">2023-06-15T11:06:29</div><input id="attrs-156bb6e1-af63-4703-9ea2-1c4d42d74fae" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-156bb6e1-af63-4703-9ea2-1c4d42d74fae" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-15080721-b2e0-4f49-8d5f-88092937a74e" class="xr-var-data-in" type="checkbox"><label for="data-15080721-b2e0-4f49-8d5f-88092937a74e" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array(['2023-06-15T11:06:29.000000000'], dtype='datetime64[ns]')</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-5ca23c37-a203-4afb-94ef-674049ffeebf" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-5ca23c37-a203-4afb-94ef-674049ffeebf" class="xr-section-summary">Data variables: <span>(7)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>cloud</span></div><div class="xr-var-dims">(time, y, x)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">dask.array&lt;chunksize=(1, 1073, 1072), meta=np.ndarray&gt;</div><input id="attrs-6f0efd6c-4632-45c6-935e-5f20a52a2b30" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-6f0efd6c-4632-45c6-935e-5f20a52a2b30" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-e17c6f03-9186-49a9-990e-61d1fbb19517" class="xr-var-data-in" type="checkbox"><label for="data-e17c6f03-9186-49a9-990e-61d1fbb19517" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th></th>
<th data-quarto-table-cell-role="th">Array</th>
<th data-quarto-table-cell-role="th">Chunk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Bytes</td>
<td>4.39 MiB</td>
<td>4.39 MiB</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Shape</td>
<td>(1, 1073, 1072)</td>
<td>(1, 1073, 1072)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dask graph</td>
<td colspan="2">1 chunks in 1 graph layer</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Data type</td>
<td colspan="2">float32 numpy.ndarray</td>
</tr>
</tbody>
</table></td>
<td><svg width="194" height="184" style="stroke:rgb(0,0,0);stroke-width:1">
<!-- Horizontal lines --> <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2"></line> <line x1="10" y1="120" x2="24" y2="134" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2"></line> <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,134.9485979497544 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="10" y1="0" x2="129" y2="0" style="stroke-width:2"></line> <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2"></line> <line x1="129" y1="0" x2="144" y2="14" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 129.88816402609507,0.0 144.83676197584947,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2"></line> <line x1="24" y1="134" x2="144" y2="134" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2"></line> <line x1="144" y1="14" x2="144" y2="134" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="24.9485979497544,14.948597949754403 144.83676197584947,14.948597949754403 144.83676197584947,134.9485979497544 24.9485979497544,134.9485979497544" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Text --> <text x="84.892680" y="154.948598" font-size="1.0rem" font-weight="100" text-anchor="middle">1072</text> <text x="164.836762" y="74.948598" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.836762,74.948598)">1073</text> <text x="7.474299" y="147.474299" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,147.474299)">1</text>
</svg></td>
</tr>
</tbody>
</table>
</div></li><li class="xr-var-item"><div class="xr-var-name"><span>cloud_probability</span></div><div class="xr-var-dims">(time, y, x)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">dask.array&lt;chunksize=(1, 1073, 1072), meta=np.ndarray&gt;</div><input id="attrs-4a8d3d36-1c01-43d6-a5a1-fd279eb133ab" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-4a8d3d36-1c01-43d6-a5a1-fd279eb133ab" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-14c6c4f1-4101-4822-b1af-6e48b9b81c62" class="xr-var-data-in" type="checkbox"><label for="data-14c6c4f1-4101-4822-b1af-6e48b9b81c62" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th></th>
<th data-quarto-table-cell-role="th">Array</th>
<th data-quarto-table-cell-role="th">Chunk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Bytes</td>
<td>4.39 MiB</td>
<td>4.39 MiB</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Shape</td>
<td>(1, 1073, 1072)</td>
<td>(1, 1073, 1072)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dask graph</td>
<td colspan="2">1 chunks in 1 graph layer</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Data type</td>
<td colspan="2">float32 numpy.ndarray</td>
</tr>
</tbody>
</table></td>
<td><svg width="194" height="184" style="stroke:rgb(0,0,0);stroke-width:1">
<!-- Horizontal lines --> <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2"></line> <line x1="10" y1="120" x2="24" y2="134" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2"></line> <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,134.9485979497544 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="10" y1="0" x2="129" y2="0" style="stroke-width:2"></line> <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2"></line> <line x1="129" y1="0" x2="144" y2="14" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 129.88816402609507,0.0 144.83676197584947,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2"></line> <line x1="24" y1="134" x2="144" y2="134" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2"></line> <line x1="144" y1="14" x2="144" y2="134" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="24.9485979497544,14.948597949754403 144.83676197584947,14.948597949754403 144.83676197584947,134.9485979497544 24.9485979497544,134.9485979497544" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Text --> <text x="84.892680" y="154.948598" font-size="1.0rem" font-weight="100" text-anchor="middle">1072</text> <text x="164.836762" y="74.948598" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.836762,74.948598)">1073</text> <text x="7.474299" y="147.474299" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,147.474299)">1</text>
</svg></td>
</tr>
</tbody>
</table>
</div></li><li class="xr-var-item"><div class="xr-var-name"><span>thumbnail</span></div><div class="xr-var-dims">(time, y, x)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">dask.array&lt;chunksize=(1, 1073, 1072), meta=np.ndarray&gt;</div><input id="attrs-d620a778-6046-4912-b1a4-6c29a2fab65f" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-d620a778-6046-4912-b1a4-6c29a2fab65f" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-1479f305-20ee-46fb-accc-894fd12b3ac8" class="xr-var-data-in" type="checkbox"><label for="data-1479f305-20ee-46fb-accc-894fd12b3ac8" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th></th>
<th data-quarto-table-cell-role="th">Array</th>
<th data-quarto-table-cell-role="th">Chunk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Bytes</td>
<td>4.39 MiB</td>
<td>4.39 MiB</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Shape</td>
<td>(1, 1073, 1072)</td>
<td>(1, 1073, 1072)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dask graph</td>
<td colspan="2">1 chunks in 1 graph layer</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Data type</td>
<td colspan="2">float32 numpy.ndarray</td>
</tr>
</tbody>
</table></td>
<td><svg width="194" height="184" style="stroke:rgb(0,0,0);stroke-width:1">
<!-- Horizontal lines --> <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2"></line> <line x1="10" y1="120" x2="24" y2="134" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2"></line> <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,134.9485979497544 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="10" y1="0" x2="129" y2="0" style="stroke-width:2"></line> <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2"></line> <line x1="129" y1="0" x2="144" y2="14" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 129.88816402609507,0.0 144.83676197584947,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2"></line> <line x1="24" y1="134" x2="144" y2="134" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2"></line> <line x1="144" y1="14" x2="144" y2="134" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="24.9485979497544,14.948597949754403 144.83676197584947,14.948597949754403 144.83676197584947,134.9485979497544 24.9485979497544,134.9485979497544" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Text --> <text x="84.892680" y="154.948598" font-size="1.0rem" font-weight="100" text-anchor="middle">1072</text> <text x="164.836762" y="74.948598" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.836762,74.948598)">1073</text> <text x="7.474299" y="147.474299" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,147.474299)">1</text>
</svg></td>
</tr>
</tbody>
</table>
</div></li><li class="xr-var-item"><div class="xr-var-name"><span>topographic_shadow</span></div><div class="xr-var-dims">(time, y, x)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">dask.array&lt;chunksize=(1, 1073, 1072), meta=np.ndarray&gt;</div><input id="attrs-8e8ef5ac-4e2c-4cbe-bafe-c35c266a7fc6" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-8e8ef5ac-4e2c-4cbe-bafe-c35c266a7fc6" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-9e19d5e4-9f02-43ef-a462-11178d476899" class="xr-var-data-in" type="checkbox"><label for="data-9e19d5e4-9f02-43ef-a462-11178d476899" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th></th>
<th data-quarto-table-cell-role="th">Array</th>
<th data-quarto-table-cell-role="th">Chunk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Bytes</td>
<td>4.39 MiB</td>
<td>4.39 MiB</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Shape</td>
<td>(1, 1073, 1072)</td>
<td>(1, 1073, 1072)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dask graph</td>
<td colspan="2">1 chunks in 1 graph layer</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Data type</td>
<td colspan="2">float32 numpy.ndarray</td>
</tr>
</tbody>
</table></td>
<td><svg width="194" height="184" style="stroke:rgb(0,0,0);stroke-width:1">
<!-- Horizontal lines --> <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2"></line> <line x1="10" y1="120" x2="24" y2="134" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2"></line> <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,134.9485979497544 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="10" y1="0" x2="129" y2="0" style="stroke-width:2"></line> <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2"></line> <line x1="129" y1="0" x2="144" y2="14" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 129.88816402609507,0.0 144.83676197584947,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2"></line> <line x1="24" y1="134" x2="144" y2="134" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2"></line> <line x1="144" y1="14" x2="144" y2="134" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="24.9485979497544,14.948597949754403 144.83676197584947,14.948597949754403 144.83676197584947,134.9485979497544 24.9485979497544,134.9485979497544" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Text --> <text x="84.892680" y="154.948598" font-size="1.0rem" font-weight="100" text-anchor="middle">1072</text> <text x="164.836762" y="74.948598" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.836762,74.948598)">1073</text> <text x="7.474299" y="147.474299" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,147.474299)">1</text>
</svg></td>
</tr>
</tbody>
</table>
</div></li><li class="xr-var-item"><div class="xr-var-name"><span>cog</span></div><div class="xr-var-dims">(time, y, x)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">dask.array&lt;chunksize=(1, 1073, 1072), meta=np.ndarray&gt;</div><input id="attrs-ad5cc182-2533-49eb-b510-6893a9460b25" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-ad5cc182-2533-49eb-b510-6893a9460b25" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-66106a58-5989-4e3f-b2f8-19b4e13e79f0" class="xr-var-data-in" type="checkbox"><label for="data-66106a58-5989-4e3f-b2f8-19b4e13e79f0" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th></th>
<th data-quarto-table-cell-role="th">Array</th>
<th data-quarto-table-cell-role="th">Chunk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Bytes</td>
<td>4.39 MiB</td>
<td>4.39 MiB</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Shape</td>
<td>(1, 1073, 1072)</td>
<td>(1, 1073, 1072)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dask graph</td>
<td colspan="2">1 chunks in 1 graph layer</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Data type</td>
<td colspan="2">float32 numpy.ndarray</td>
</tr>
</tbody>
</table></td>
<td><svg width="194" height="184" style="stroke:rgb(0,0,0);stroke-width:1">
<!-- Horizontal lines --> <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2"></line> <line x1="10" y1="120" x2="24" y2="134" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2"></line> <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,134.9485979497544 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="10" y1="0" x2="129" y2="0" style="stroke-width:2"></line> <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2"></line> <line x1="129" y1="0" x2="144" y2="14" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 129.88816402609507,0.0 144.83676197584947,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2"></line> <line x1="24" y1="134" x2="144" y2="134" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2"></line> <line x1="144" y1="14" x2="144" y2="134" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="24.9485979497544,14.948597949754403 144.83676197584947,14.948597949754403 144.83676197584947,134.9485979497544 24.9485979497544,134.9485979497544" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Text --> <text x="84.892680" y="154.948598" font-size="1.0rem" font-weight="100" text-anchor="middle">1072</text> <text x="164.836762" y="74.948598" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.836762,74.948598)">1073</text> <text x="7.474299" y="147.474299" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,147.474299)">1</text>
</svg></td>
</tr>
</tbody>
</table>
</div></li><li class="xr-var-item"><div class="xr-var-name"><span>valid_pixels</span></div><div class="xr-var-dims">(time, y, x)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">dask.array&lt;chunksize=(1, 1073, 1072), meta=np.ndarray&gt;</div><input id="attrs-c9531539-a265-4ee3-8d43-525af1f341b6" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-c9531539-a265-4ee3-8d43-525af1f341b6" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-eb81e7a2-adb6-4bc2-9016-95a394899a34" class="xr-var-data-in" type="checkbox"><label for="data-eb81e7a2-adb6-4bc2-9016-95a394899a34" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th></th>
<th data-quarto-table-cell-role="th">Array</th>
<th data-quarto-table-cell-role="th">Chunk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Bytes</td>
<td>4.39 MiB</td>
<td>4.39 MiB</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Shape</td>
<td>(1, 1073, 1072)</td>
<td>(1, 1073, 1072)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dask graph</td>
<td colspan="2">1 chunks in 1 graph layer</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Data type</td>
<td colspan="2">float32 numpy.ndarray</td>
</tr>
</tbody>
</table></td>
<td><svg width="194" height="184" style="stroke:rgb(0,0,0);stroke-width:1">
<!-- Horizontal lines --> <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2"></line> <line x1="10" y1="120" x2="24" y2="134" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2"></line> <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,134.9485979497544 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="10" y1="0" x2="129" y2="0" style="stroke-width:2"></line> <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2"></line> <line x1="129" y1="0" x2="144" y2="14" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 129.88816402609507,0.0 144.83676197584947,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2"></line> <line x1="24" y1="134" x2="144" y2="134" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2"></line> <line x1="144" y1="14" x2="144" y2="134" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="24.9485979497544,14.948597949754403 144.83676197584947,14.948597949754403 144.83676197584947,134.9485979497544 24.9485979497544,134.9485979497544" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Text --> <text x="84.892680" y="154.948598" font-size="1.0rem" font-weight="100" text-anchor="middle">1072</text> <text x="164.836762" y="74.948598" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.836762,74.948598)">1073</text> <text x="7.474299" y="147.474299" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,147.474299)">1</text>
</svg></td>
</tr>
</tbody>
</table>
</div></li><li class="xr-var-item"><div class="xr-var-name"><span>saturated_pixels</span></div><div class="xr-var-dims">(time, y, x)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">dask.array&lt;chunksize=(1, 1073, 1072), meta=np.ndarray&gt;</div><input id="attrs-73d96803-6963-4eb2-b7a6-4ac052fe8859" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-73d96803-6963-4eb2-b7a6-4ac052fe8859" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-345da91f-d1c5-48b0-a999-949cfd9d7fe0" class="xr-var-data-in" type="checkbox"><label for="data-345da91f-d1c5-48b0-a999-949cfd9d7fe0" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th></th>
<th data-quarto-table-cell-role="th">Array</th>
<th data-quarto-table-cell-role="th">Chunk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Bytes</td>
<td>4.39 MiB</td>
<td>4.39 MiB</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Shape</td>
<td>(1, 1073, 1072)</td>
<td>(1, 1073, 1072)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dask graph</td>
<td colspan="2">1 chunks in 1 graph layer</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Data type</td>
<td colspan="2">float32 numpy.ndarray</td>
</tr>
</tbody>
</table></td>
<td><svg width="194" height="184" style="stroke:rgb(0,0,0);stroke-width:1">
<!-- Horizontal lines --> <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2"></line> <line x1="10" y1="120" x2="24" y2="134" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2"></line> <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,134.9485979497544 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="10" y1="0" x2="129" y2="0" style="stroke-width:2"></line> <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2"></line> <line x1="129" y1="0" x2="144" y2="14" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="10.0,0.0 129.88816402609507,0.0 144.83676197584947,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Horizontal lines --> <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2"></line> <line x1="24" y1="134" x2="144" y2="134" style="stroke-width:2"></line> <!-- Vertical lines --> <line x1="24" y1="14" x2="24" y2="134" style="stroke-width:2"></line> <line x1="144" y1="14" x2="144" y2="134" style="stroke-width:2"></line> <!-- Colored Rectangle --> <polygon points="24.9485979497544,14.948597949754403 144.83676197584947,14.948597949754403 144.83676197584947,134.9485979497544 24.9485979497544,134.9485979497544" style="fill:#ECB172A0;stroke-width:0"></polygon> <!-- Text --> <text x="84.892680" y="154.948598" font-size="1.0rem" font-weight="100" text-anchor="middle">1072</text> <text x="164.836762" y="74.948598" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.836762,74.948598)">1073</text> <text x="7.474299" y="147.474299" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,147.474299)">1</text>
</svg></td>
</tr>
</tbody>
</table>
</div></li></ul></div></li><li class="xr-section-item"><input id="section-ca679055-c2e9-4531-9fc8-cd78d6577177" class="xr-section-summary-in" type="checkbox"><label for="section-ca679055-c2e9-4531-9fc8-cd78d6577177" class="xr-section-summary">Indexes: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>y</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-647c8f2c-6829-4800-8d08-0a7acbeefa13" class="xr-index-data-in" type="checkbox"><label for="index-647c8f2c-6829-4800-8d08-0a7acbeefa13" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([6863520.0, 6863200.0, 6862880.0, 6862560.0, 6862240.0, 6861920.0,
       6861600.0, 6861280.0, 6860960.0, 6860640.0,
       ...
       6523360.0, 6523040.0, 6522720.0, 6522400.0, 6522080.0, 6521760.0,
       6521440.0, 6521120.0, 6520800.0, 6520480.0],
      dtype='float64', name='y', length=1073))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>x</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-f661a91f-9eaa-4031-967f-41e2e554cb36" class="xr-index-data-in" type="checkbox"><label for="index-f661a91f-9eaa-4031-967f-41e2e554cb36" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([-333920.0, -333600.0, -333280.0, -332960.0, -332640.0, -332320.0,
       -332000.0, -331680.0, -331360.0, -331040.0,
       ...
          5920.0,    6240.0,    6560.0,    6880.0,    7200.0,    7520.0,
          7840.0,    8160.0,    8480.0,    8800.0],
      dtype='float64', name='x', length=1072))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>time</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-b7949474-cc74-42b4-9244-e0139d5efc1e" class="xr-index-data-in" type="checkbox"><label for="index-b7949474-cc74-42b4-9244-e0139d5efc1e" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(DatetimeIndex(['2023-06-15 11:06:29'], dtype='datetime64[ns]', name='time', freq=None))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-8439393d-ef44-4b0d-9e84-e1c6ffccc1e1" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-8439393d-ef44-4b0d-9e84-e1c6ffccc1e1" class="xr-section-summary" title="Expand/collapse section">Attributes: <span>(0)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"></dl></div></li></ul></div></div>
</div>
</div>
<p>As you can see, the assets are the high level keys again. we want to be able to get a list of <code>cog.href</code> and the associated <code>eo:bands</code> information that goes with them. When compute is run, the following errors are returned.</p>
<div id="8806a2d9" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>cx <span class="op">=</span> cx.compute()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/al/miniforge3/envs/eodh/lib/python3.12/site-packages/rasterio/__init__.py:304: NotGeoreferencedWarning: Dataset has no geotransform, gcps, or rpcs. The identity matrix will be returned.
  dataset = DatasetReader(path, driver=driver, sharing=sharing, **kwargs)
2024-10-07 16:10:31,545 - distributed.worker - WARNING - Compute Failed
Key:       ('thumbnail-f42188f69d7a89dba4e2305f6a750c13', 0, 0, 0)
Function:  _dask_loader_tyx
args:      ([[RasterSource(uri='https://dap.ceda.ac.uk/neodc/sentinel_ard/data/sentinel_2/2023/06/15/S2B_20230615_latn509lonw0008_T30UXB_ORB137_20230615131239_utm30n_osgb_vmsk_sharp_rad_srefdem_stdsref_thumbnail.jpg', band=1, subdataset=None, geobox=None, meta=None), RasterSource(uri='https://dap.ceda.ac.uk/neodc/sentinel_ard/data/sentinel_2/2023/06/15/S2B_20230615_latn510lonw0022_T30UWB_ORB137_20230615131239_utm30n_osgb_vmsk_sharp_rad_srefdem_stdsref_thumbnail.jpg', band=1, subdataset=None, geobox=None, meta=None), RasterSource(uri='https://dap.ceda.ac.uk/neodc/sentinel_ard/data/sentinel_2/2023/06/15/S2B_20230615_latn518lonw0008_T30UXC_ORB137_20230615131239_utm30n_osgb_vmsk_sharp_rad_srefdem_stdsref_thumbnail.jpg', band=1, subdataset=None, geobox=None, meta=None), RasterSource(uri='https://dap.ceda.ac.uk/neodc/sentinel_ard/data/sentinel_2/2023/06/15/S2B_20230615_latn519lonw0022_T30UWC_ORB137_20230615131239_utm30n_osgb_vmsk_sharp_rad_srefdem_stdsref_thumbnail.jpg', band=1, subdataset=None, geobox
kwargs:    {}
Exception: 'AssertionError()'
</code></pre>
</div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AssertionError</span>                            Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[35], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> cx <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">cx</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">compute</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/miniforge3/envs/eodh/lib/python3.12/site-packages/xarray/core/dataset.py:1035</span>, in <span class="ansi-cyan-fg">Dataset.compute</span><span class="ansi-blue-fg">(self, **kwargs)</span>
<span class="ansi-green-fg ansi-bold">   1011</span> <span style="font-style:italic;color:rgb(175,0,0)">"""Manually trigger loading and/or computation of this dataset's data</span>
<span class="ansi-green-fg ansi-bold">   1012</span> <span style="font-style:italic;color:rgb(175,0,0)">from disk or a remote source into memory and return a new dataset.</span>
<span class="ansi-green-fg ansi-bold">   1013</span> <span style="font-style:italic;color:rgb(175,0,0)">Unlike load, the original dataset is left unaltered.</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">   1032</span> <span style="font-style:italic;color:rgb(175,0,0)">dask.compute</span>
<span class="ansi-green-fg ansi-bold">   1033</span> <span style="font-style:italic;color:rgb(175,0,0)">"""</span>
<span class="ansi-green-fg ansi-bold">   1034</span> new <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>copy(deep<span style="color:rgb(98,98,98)">=</span><span style="font-weight:bold;color:rgb(0,135,0)">False</span>)
<span class="ansi-green-fg">-&gt; 1035</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">new</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">load</span><span class="ansi-yellow-bg">(</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/miniforge3/envs/eodh/lib/python3.12/site-packages/xarray/core/dataset.py:862</span>, in <span class="ansi-cyan-fg">Dataset.load</span><span class="ansi-blue-fg">(self, **kwargs)</span>
<span class="ansi-green-fg ansi-bold">    859</span> chunkmanager <span style="color:rgb(98,98,98)">=</span> get_chunked_array_type(<span style="color:rgb(98,98,98)">*</span>lazy_data<span style="color:rgb(98,98,98)">.</span>values())
<span class="ansi-green-fg ansi-bold">    861</span> <span style="font-style:italic;color:rgb(95,135,135)"># evaluate all the chunked arrays simultaneously</span>
<span class="ansi-green-fg">--&gt; 862</span> evaluated_data: <span style="color:rgb(0,135,0)">tuple</span>[np<span style="color:rgb(98,98,98)">.</span>ndarray[Any, Any], <span style="color:rgb(98,98,98)">.</span><span style="color:rgb(98,98,98)">.</span><span style="color:rgb(98,98,98)">.</span>] <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">chunkmanager</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">compute</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg ansi-bold">    863</span> <span class="ansi-yellow-bg">    </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">lazy_data</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">values</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">kwargs</span>
<span class="ansi-green-fg ansi-bold">    864</span> <span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    866</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> k, data <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="color:rgb(0,135,0)">zip</span>(lazy_data, evaluated_data):
<span class="ansi-green-fg ansi-bold">    867</span>     <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>variables[k]<span style="color:rgb(98,98,98)">.</span>data <span style="color:rgb(98,98,98)">=</span> data

File <span class="ansi-green-fg">~/miniforge3/envs/eodh/lib/python3.12/site-packages/xarray/namedarray/daskmanager.py:86</span>, in <span class="ansi-cyan-fg">DaskManager.compute</span><span class="ansi-blue-fg">(self, *data, **kwargs)</span>
<span class="ansi-green-fg ansi-bold">     81</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">compute</span>(
<span class="ansi-green-fg ansi-bold">     82</span>     <span style="color:rgb(0,135,0)">self</span>, <span style="color:rgb(98,98,98)">*</span>data: Any, <span style="color:rgb(98,98,98)">*</span><span style="color:rgb(98,98,98)">*</span>kwargs: Any
<span class="ansi-green-fg ansi-bold">     83</span> ) <span style="color:rgb(98,98,98)">-</span><span style="color:rgb(98,98,98)">&gt;</span> <span style="color:rgb(0,135,0)">tuple</span>[np<span style="color:rgb(98,98,98)">.</span>ndarray[Any, _DType_co], <span style="color:rgb(98,98,98)">.</span><span style="color:rgb(98,98,98)">.</span><span style="color:rgb(98,98,98)">.</span>]:
<span class="ansi-green-fg ansi-bold">     84</span>     <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">dask</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">array</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> compute
<span class="ansi-green-fg">---&gt; 86</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">compute</span><span class="ansi-yellow-bg">(</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/miniforge3/envs/eodh/lib/python3.12/site-packages/dask/base.py:661</span>, in <span class="ansi-cyan-fg">compute</span><span class="ansi-blue-fg">(traverse, optimize_graph, scheduler, get, *args, **kwargs)</span>
<span class="ansi-green-fg ansi-bold">    658</span>     postcomputes<span style="color:rgb(98,98,98)">.</span>append(x<span style="color:rgb(98,98,98)">.</span>__dask_postcompute__())
<span class="ansi-green-fg ansi-bold">    660</span> <span style="font-weight:bold;color:rgb(0,135,0)">with</span> shorten_traceback():
<span class="ansi-green-fg">--&gt; 661</span>     results <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">schedule</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">dsk</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">keys</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    663</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> repack([f(r, <span style="color:rgb(98,98,98)">*</span>a) <span style="font-weight:bold;color:rgb(0,135,0)">for</span> r, (f, a) <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="color:rgb(0,135,0)">zip</span>(results, postcomputes)])

File <span class="ansi-green-fg">~/miniforge3/envs/eodh/lib/python3.12/site-packages/odc/stac/_load.py:696</span>, in <span class="ansi-cyan-fg">_dask_loader_tyx</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg ansi-bold">    694</span> <span style="font-weight:bold;color:rgb(0,135,0)">with</span> rio_env(<span style="color:rgb(98,98,98)">*</span><span style="color:rgb(98,98,98)">*</span>env):
<span class="ansi-green-fg ansi-bold">    695</span>     <span style="font-weight:bold;color:rgb(0,135,0)">for</span> i, plane <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="color:rgb(0,135,0)">enumerate</span>(srcs):
<span class="ansi-green-fg">--&gt; 696</span>         _fill_2d_slice(plane, gbox, cfg, chunk[i, :, :])
<span class="ansi-green-fg ansi-bold">    697</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> chunk

File <span class="ansi-green-fg">~/miniforge3/envs/eodh/lib/python3.12/site-packages/odc/stac/_load.py:724</span>, in <span class="ansi-cyan-fg">_fill_2d_slice</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg ansi-bold">    721</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> dst
<span class="ansi-green-fg ansi-bold">    723</span> src, <span style="color:rgb(98,98,98)">*</span>rest <span style="color:rgb(98,98,98)">=</span> srcs
<span class="ansi-green-fg">--&gt; 724</span> _roi, pix <span style="color:rgb(98,98,98)">=</span> rio_read(src, cfg, dst_gbox, dst<span style="color:rgb(98,98,98)">=</span>dst)
<span class="ansi-green-fg ansi-bold">    726</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> src <span style="font-weight:bold;color:rgb(175,0,255)">in</span> rest:
<span class="ansi-green-fg ansi-bold">    727</span>     <span style="font-style:italic;color:rgb(95,135,135)"># first valid pixel takes precedence over others</span>
<span class="ansi-green-fg ansi-bold">    728</span>     _roi, pix <span style="color:rgb(98,98,98)">=</span> rio_read(src, cfg, dst_gbox)

File <span class="ansi-green-fg">~/miniforge3/envs/eodh/lib/python3.12/site-packages/odc/stac/_reader.py:186</span>, in <span class="ansi-cyan-fg">rio_read</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg ansi-bold">    163</span> <span style="font-style:italic;color:rgb(175,0,0)">"""</span>
<span class="ansi-green-fg ansi-bold">    164</span> <span style="font-style:italic;color:rgb(175,0,0)">Internal read method.</span>
<span class="ansi-green-fg ansi-bold">    165</span> 
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">    182</span> 
<span class="ansi-green-fg ansi-bold">    183</span> <span style="font-style:italic;color:rgb(175,0,0)">"""</span>
<span class="ansi-green-fg ansi-bold">    185</span> <span style="font-weight:bold;color:rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">--&gt; 186</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> _rio_read(src, cfg, dst_geobox, dst)
<span class="ansi-green-fg ansi-bold">    187</span> <span style="font-weight:bold;color:rgb(0,135,0)">except</span> (
<span class="ansi-green-fg ansi-bold">    188</span>     rasterio<span style="color:rgb(98,98,98)">.</span>errors<span style="color:rgb(98,98,98)">.</span>RasterioIOError,
<span class="ansi-green-fg ansi-bold">    189</span>     rasterio<span style="color:rgb(98,98,98)">.</span>errors<span style="color:rgb(98,98,98)">.</span>RasterBlockError,
<span class="ansi-green-fg ansi-bold">    190</span>     rasterio<span style="color:rgb(98,98,98)">.</span>errors<span style="color:rgb(98,98,98)">.</span>WarpOperationError,
<span class="ansi-green-fg ansi-bold">    191</span>     rasterio<span style="color:rgb(98,98,98)">.</span>errors<span style="color:rgb(98,98,98)">.</span>WindowEvaluationError,
<span class="ansi-green-fg ansi-bold">    192</span> ) <span style="font-weight:bold;color:rgb(0,135,0)">as</span> e:
<span class="ansi-green-fg ansi-bold">    193</span>     <span style="font-weight:bold;color:rgb(0,135,0)">if</span> cfg<span style="color:rgb(98,98,98)">.</span>fail_on_error:

File <span class="ansi-green-fg">~/miniforge3/envs/eodh/lib/python3.12/site-packages/odc/stac/_reader.py:239</span>, in <span class="ansi-cyan-fg">_rio_read</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg ansi-bold">    236</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> src<span style="color:rgb(98,98,98)">.</span>band <span style="color:rgb(98,98,98)">&gt;</span> rdr<span style="color:rgb(98,98,98)">.</span>count:
<span class="ansi-green-fg ansi-bold">    237</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> <span style="font-weight:bold;color:rgb(215,95,95)">ValueError</span>(<span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">No band </span><span style="font-weight:bold;color:rgb(175,95,135)">{</span>src<span style="color:rgb(98,98,98)">.</span>band<span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)"> in </span><span style="color:rgb(175,0,0)">'</span><span style="font-weight:bold;color:rgb(175,95,135)">{</span>src<span style="color:rgb(98,98,98)">.</span>uri<span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg">--&gt; 239</span> rr <span style="color:rgb(98,98,98)">=</span> _reproject_info_from_rio(rdr, dst_geobox, ttol<span style="color:rgb(98,98,98)">=</span>ttol)
<span class="ansi-green-fg ansi-bold">    241</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> cfg<span style="color:rgb(98,98,98)">.</span>use_overviews <span style="font-weight:bold;color:rgb(175,0,255)">and</span> rr<span style="color:rgb(98,98,98)">.</span>read_shrink <span style="color:rgb(98,98,98)">&gt;</span> <span style="color:rgb(98,98,98)">1</span>:
<span class="ansi-green-fg ansi-bold">    242</span>     ovr_idx <span style="color:rgb(98,98,98)">=</span> _pick_overview(rr<span style="color:rgb(98,98,98)">.</span>read_shrink, rdr<span style="color:rgb(98,98,98)">.</span>overviews(src<span style="color:rgb(98,98,98)">.</span>band))

File <span class="ansi-green-fg">~/miniforge3/envs/eodh/lib/python3.12/site-packages/odc/stac/_reader.py:100</span>, in <span class="ansi-cyan-fg">_reproject_info_from_rio</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg ansi-bold">     97</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">_reproject_info_from_rio</span>(
<span class="ansi-green-fg ansi-bold">     98</span>     rdr: rasterio<span style="color:rgb(98,98,98)">.</span>DatasetReader, dst_geobox: GeoBox, ttol: <span style="color:rgb(0,135,0)">float</span>
<span class="ansi-green-fg ansi-bold">     99</span> ) <span style="color:rgb(98,98,98)">-</span><span style="color:rgb(98,98,98)">&gt;</span> ReprojectInfo:
<span class="ansi-green-fg">--&gt; 100</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> compute_reproject_roi(rio_geobox(rdr), dst_geobox, ttol<span style="color:rgb(98,98,98)">=</span>ttol)

File <span class="ansi-green-fg">~/miniforge3/envs/eodh/lib/python3.12/site-packages/odc/geo/overlap.py:489</span>, in <span class="ansi-cyan-fg">compute_reproject_roi</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg ansi-bold">    485</span> <span style="font-style:italic;color:rgb(95,135,135)"># pylint: disable=too-many-locals</span>
<span class="ansi-green-fg ansi-bold">    487</span> pts_per_side <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(98,98,98)">5</span>
<span class="ansi-green-fg">--&gt; 489</span> tr <span style="color:rgb(98,98,98)">=</span> native_pix_transform(src, dst)
<span class="ansi-green-fg ansi-bold">    491</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> tr<span style="color:rgb(98,98,98)">.</span>linear <span style="font-weight:bold;color:rgb(175,0,255)">is</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>:
<span class="ansi-green-fg ansi-bold">    492</span>     padding <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(98,98,98)">1</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> padding <span style="font-weight:bold;color:rgb(175,0,255)">is</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span> <span style="font-weight:bold;color:rgb(0,135,0)">else</span> padding

File <span class="ansi-green-fg">~/miniforge3/envs/eodh/lib/python3.12/site-packages/odc/geo/overlap.py:337</span>, in <span class="ansi-cyan-fg">native_pix_transform</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg ansi-bold">    334</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="color:rgb(0,135,0)">isinstance</span>(src, GeoBox) <span style="font-weight:bold;color:rgb(175,0,255)">and</span> <span style="color:rgb(0,135,0)">isinstance</span>(dst, GeoBox) <span style="font-weight:bold;color:rgb(175,0,255)">and</span> src<span style="color:rgb(98,98,98)">.</span>crs <span style="color:rgb(98,98,98)">==</span> dst<span style="color:rgb(98,98,98)">.</span>crs:
<span class="ansi-green-fg ansi-bold">    335</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> _same_crs_pix_transform(src, dst)
<span class="ansi-green-fg">--&gt; 337</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> GbxPointTransform(src, dst)

File <span class="ansi-green-fg">~/miniforge3/envs/eodh/lib/python3.12/site-packages/odc/geo/overlap.py:102</span>, in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg ansi-bold">     96</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">__init__</span>(
<span class="ansi-green-fg ansi-bold">     97</span>     <span style="color:rgb(0,135,0)">self</span>,
<span class="ansi-green-fg ansi-bold">     98</span>     src: GeoBoxBase,
<span class="ansi-green-fg ansi-bold">     99</span>     dst: GeoBoxBase,
<span class="ansi-green-fg ansi-bold">    100</span>     back: Optional[<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">GbxPointTransform</span><span style="color:rgb(175,0,0)">"</span>] <span style="color:rgb(98,98,98)">=</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>,
<span class="ansi-green-fg ansi-bold">    101</span> ):
<span class="ansi-green-fg">--&gt; 102</span>     <span style="font-weight:bold;color:rgb(0,135,0)">assert</span> src<span style="color:rgb(98,98,98)">.</span>crs <span style="font-weight:bold;color:rgb(175,0,255)">is</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span> <span style="font-weight:bold;color:rgb(175,0,255)">and</span> dst<span style="color:rgb(98,98,98)">.</span>crs <span style="font-weight:bold;color:rgb(175,0,255)">is</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>
<span class="ansi-green-fg ansi-bold">    103</span>     <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_src <span style="color:rgb(98,98,98)">=</span> src
<span class="ansi-green-fg ansi-bold">    104</span>     <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_dst <span style="color:rgb(98,98,98)">=</span> dst

<span class="ansi-red-fg">AssertionError</span>: </pre>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ajgwords\.github\.io\/eodh-tests\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>